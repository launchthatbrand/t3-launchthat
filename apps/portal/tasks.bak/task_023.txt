# Task ID: 23
# Title: Implement Payment Processing Flow
# Status: pending
# Dependencies: 21, 22
# Priority: high
# Description: Create the complete payment processing flow from client-side tokenization to transaction creation.
# Details:
Implement the client-side payment submission flow. Create a Convex action (internalCreateAuthNetTransaction) for processing payments. Handle user creation/association based on Clerk authentication: if user is logged in (check via Clerk's useAuth), pass the Clerk user ID to the Convex action; if not logged in, implement logic to either prompt for signup/login via Clerk before checkout, or create/associate a user record in Convex based on email collected during guest checkout, potentially linking to a Clerk user later if they sign up with the same email. Ensure transaction records link to the correct user ID (either Convex internal ID or Clerk ID stored in Convex). Implement error handling and validation. Ensure transaction records are created with proper details.

# Test Strategy:
Test the complete payment flow from form submission to transaction creation. Verify that transactions are correctly recorded in the database and linked to the appropriate user ID. Test both authenticated (Clerk) user flows and guest checkout flows. Verify that guest users can be properly associated with Clerk accounts if they later sign up. Test error scenarios and validation. Ensure user association works correctly for both authenticated and unauthenticated users.
