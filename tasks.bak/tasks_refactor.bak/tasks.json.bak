{
  "tasks": [
    {
      "id": 1,
      "title": "Analyze Existing Convex Backend Structure",
      "description": "Perform a comprehensive analysis of the current Convex backend structure in apps/portal/convex/",
      "status": "done",
      "dependencies": [],
      "priority": "high",
      "details": "1. Analyze codebase size and composition through either:\n   a. Install and use a code analysis tool like 'cloc' or 'tokei', OR\n   b. Perform manual analysis if tool installation is not feasible.\n2. Create a detailed map of the current file structure and dependencies.\n3. Identify common patterns, redundancies, and potential areas for improvement.\n4. Document findings in a structured report, including recommendations for the new directory structure.",
      "testStrategy": "Peer review of the analysis report by senior developers to ensure completeness and accuracy.",
      "subtasks": [
        {
          "id": "1.1",
          "title": "Resolve code analysis tool issue",
          "description": "Decide on approach for codebase size and composition analysis",
          "details": "Options:\n1. Install 'cloc' or 'tokei' tools for automated analysis\n2. Skip automated analysis and rely on manual review if tool installation is not practical\n3. Document decision and reasoning",
          "status": "completed"
        },
        {
          "id": "2.1",
          "title": "Decision on Code Analysis Tool Usage",
          "description": "Document the decision regarding the use of automated code analysis tools like cloc or tokei for Task 1.",
          "details": "Initial attempt to run cloc failed as the command was not found. Sub-step 1 of Task 1 requires codebase size and composition analysis. Decision needed: install tool or rely on manual analysis.",
          "status": "completed",
          "dependencies": [],
          "parentTaskId": 1
        },
        {
          "id": "1.2",
          "title": "Map Current File Structure and Dependencies",
          "description": "Document the current file structure and dependencies in the apps/portal/convex/ directory",
          "details": "Identified approximately 40-50 files including:\n- Schema files (schema.ts, usersSchema.ts, permissionsSchema.ts, etc.)\n- Logic files (permissions.ts, users.ts, products.ts, etc.)\n- Specialized directories (calendar/, contacts/, cms/, actions/, lib/)\n- Configuration files (auth.config.ts, convex.json, http.ts, env.ts)\n- Dependencies between these files have been mapped",
          "status": "completed",
          "parentTaskId": 1
        },
        {
          "id": "1.3",
          "title": "Identify Patterns, Redundancies, and Improvement Areas",
          "description": "Document common patterns, redundancies, and potential areas for improvement in the codebase",
          "details": "Identified:\n- Patterns: Modular schema definitions, use of 'v' for validators, auth/authz patterns\n- Redundancies: Flat structure for core features making navigation difficult\n- Improvement areas: Need for more shared utility functions, consistent args/returns validators, standardized error handling, consistent naming conventions",
          "status": "completed",
          "parentTaskId": 1
        },
        {
          "id": "1.4",
          "title": "Compile Analysis Report",
          "description": "Compile findings into a structured report with recommendations for the new directory structure",
          "details": "The apps/portal/scripts/convex_refactor_prd.md document serves as the primary structured report for this analysis, including detailed requirements and a proposed new directory structure based on the findings.",
          "status": "completed",
          "parentTaskId": 1
        },
        {
          "id": "1.5",
          "title": "Review Analysis Completion",
          "description": "Review the completed analysis to ensure all requirements of Task 1 have been met",
          "details": "Verify that all four components of the analysis have been completed:\n1. Codebase size/composition analysis (decision to use manual analysis documented)\n2. Detailed map of file structure and dependencies\n3. Identification of patterns, redundancies, and improvement areas\n4. Documentation of findings in structured report",
          "status": "done",
          "parentTaskId": 1
        }
      ]
    },
    {
      "id": 2,
      "title": "Design New Directory Structure",
      "description": "Create a detailed plan for the new feature-based directory structure",
      "status": "done",
      "dependencies": [
        1
      ],
      "priority": "high",
      "details": "1. Based on the analysis, create a comprehensive directory structure plan.\n2. Include all feature-specific directories (e.g., ecommerce/, lms/, users/, permissions/, groups/, downloads/, calendar/, notifications/, cms/).\n3. Define the structure for shared utilities (e.g., shared/ or utils/ directory).\n4. Specify naming conventions for schema files, query files, mutation files, and action files.\n5. Create a visual representation of the new structure (e.g., using a tool like draw.io).",
      "testStrategy": "Review the proposed structure with the development team and stakeholders. Iterate based on feedback.",
      "subtasks": [
        {
          "id": 2.1,
          "title": "Completed Directory Structure Design",
          "description": "Detailed directory structure plan with naming conventions",
          "status": "done",
          "details": "**I. Detailed Directory Structure Plan:**\n\n```\napps/portal/convex/\n├── admin/                  # Backend logic for admin panel features\n│   ├── dashboardOps.ts     # Queries/mutations for dashboard data\n│   ├── settingsAdmin.ts    # Functions for managing system-wide settings\n│   └── schema.ts           # Schema for any admin-specific tables (if any)\n├── auth/                   # Authentication related hooks, configs used by Convex\n│   └── auth.config.ts      # (Existing file, likely stays here or is confirmed as central auth point)\n├── calendar/\n│   ├── calendar.ts         # Core calendar logic (queries, mutations)\n│   ├── events.ts           # Event-specific logic\n│   └── schema.ts           # Combined schema for calendar and events tables\n├── cms/                    # Content Management System (ConvexCMS specific)\n│   ├── pages.ts\n│   ├── posts.ts            # e.g., Blog posts, articles if distinct from group posts\n│   ├── media.ts            # If CMS has dedicated media handling\n│   └── schema.ts\n├── contacts/\n│   ├── contacts.ts\n│   └── schema.ts\n├── core/                   # Core, cross-cutting concerns, formerly `permissions`, `users`\n│   ├── permissions.ts      # Permission checking logic (hasPermission, requirePermission)\n│   ├── roles.ts            # Role management logic\n│   ├── users.ts            # User management logic (CRUD, profile updates)\n│   ├── schema/\n│   │   ├── permissionsSchema.ts\n│   │   ├── rolesSchema.ts\n│   │   ├── usersSchema.ts\n│   │   └── index.ts        # Exports combined core schemas\n│   └── lib/                # Helpers specific to core functionalities (e.g., permissionUtils)\n├── downloads/\n│   ├── downloads.ts        # Logic for managing digital downloads\n│   ├── downloadsLibrary.ts # Potentially for user's library of downloads\n│   └── schema.ts\n├── ecommerce/\n│   ├── cart.ts\n│   ├── checkout.ts\n│   ├── orders.ts\n│   ├── payments.ts         # Payment processing related actions/mutations\n│   ├── products.ts\n│   ├── productCategories.ts\n│   ├── productVariations.ts\n│   ├── schema/\n│   │   ├── cartSchema.ts\n│   │   ├── checkoutSchema.ts\n│   │   ├── ordersSchema.ts\n│   │   ├── paymentsSchema.ts\n│   │   ├── productsSchema.ts # Unified product schema\n│   │   ├── categoriesSchema.ts\n│   │   └── index.ts        # Exports combined ecommerce schemas\n│   └── lib/                # Ecommerce specific helpers\n├── groups/\n│   ├── groups.ts           # Group management logic\n│   ├── groupMemberships.ts\n│   ├── groupPosts.ts       # Posts within groups\n│   └── schema.ts\n├── lms/                    # Learning Management System\n│   ├── courses.ts\n│   ├── lessons.ts\n│   ├── enrollments.ts\n│   ├── progress.ts\n│   ├── topics.ts\n│   └── schema.ts\n├── notifications/\n│   ├── notifications.ts\n│   └── schema.ts\n├── shared/                 # Global utilities, shared components, constants\n│   ├── constants.ts        # e.g., Global status literals, entity types\n│   ├── pagination.ts       # Reusable pagination helpers for queries\n│   ├── schemaUtils.ts      # Common schema snippets (e.g. addressObject from current schema.ts)\n│   ├── validationUtils.ts  # Common complex validation helpers\n│   └── index.ts            # Entry point for shared utilities\n├── actions/                # Top-level/global actions (if any not fitting into features)\n│   └── generalActions.ts\n├── _generated/             # (Auto-generated by Convex)\n├── schema.ts               # Main schema aggregator (imports from feature/core schemas)\n├── http.ts                 # Root HTTP actions (e.g., webhooks not tied to a feature)\n├── crons.ts                # Cron job definitions\n├── env.ts                  # (Existing file)\n├── convex.json             # (Existing file)\n└── tsconfig.json           # (Existing file)\n```\n\n**II. Naming Conventions:**\n\n*   **Directories**: Lowercase, kebab-case if multiple words (prefer single). Example: `ecommerce`, `product-categories`.\n*   **Files**:\n    *   Logic: `camelCase.ts` (e.g., `products.ts`).\n    *   Schema: `featureNameSchema.ts` or `schema.ts` (in feature dir). Example: `productsSchema.ts`.\n    *   Utils: `camelCaseUtils.ts` or `camelCase.ts`. Example: `permissionUtils.ts`.\n*   **Convex Functions**: `verbNoun` or `verbResource`. Example: `getProduct`, `createCourse`.\n*   **Variables & Constants**: `camelCase` for vars, `UPPER_SNAKE_CASE` for consts.\n*   **Types/Interfaces**: `PascalCase`. Example: `Product`, `OrderDetails`."
        },
        {
          "id": 2.2,
          "title": "Prepare for Structure Review",
          "description": "Prepare the directory structure design for team and stakeholder review",
          "status": "done",
          "details": "1. Schedule a review meeting with the development team and key stakeholders.\n2. Prepare a presentation of the directory structure highlighting key design decisions.\n3. Document potential questions and considerations for discussion.\n4. Be prepared to explain how this structure addresses current pain points and supports future scalability."
        }
      ]
    },
    {
      "id": 3,
      "title": "Implement Base Directory Structure",
      "description": "Set up the new directory structure in the Convex backend",
      "status": "done",
      "dependencies": [
        2
      ],
      "priority": "high",
      "details": "1. Use 'mkdir' commands to create the new directory structure.\n2. Create placeholder files (e.g., .gitkeep) to maintain empty directories in version control.\n3. Update .gitignore if necessary to exclude any new temporary or generated files.\n4. Commit the new structure to version control.",
      "testStrategy": "Verify that the new directory structure matches the approved plan using directory listing tools like 'ls -R' or 'tree'.",
      "subtasks": [
        {
          "id": 3.1,
          "title": "Create directory structure with placeholder files",
          "description": "Successfully executed directory creation and placeholder files",
          "details": "Executed `cd apps/portal/convex && mkdir -p admin auth calendar cms contacts core/schema core/lib downloads ecommerce/schema ecommerce/lib groups lms notifications shared actions && touch .../.gitkeep`.\nThis created all target directories including: `admin`, `auth`, `core` (with `lib` and `schema` subdirs), `downloads`, `ecommerce` (with `lib` and `schema` subdirs), `lms`, `shared`, as well as re-created existing directories without error.",
          "status": "completed"
        },
        {
          "id": 3.2,
          "title": "Update .gitignore if necessary",
          "description": "Evaluated need for .gitignore changes",
          "details": "No changes to `.gitignore` deemed necessary at this stage, as only source code or `.gitkeep` files are involved.",
          "status": "completed"
        },
        {
          "id": 3.3,
          "title": "Commit new structure to version control",
          "description": "Prepared for commit of new directory structure",
          "details": "Suggested commit message: `feat(portal/convex): Implement new base directory structure for Convex backend`",
          "status": "completed"
        },
        {
          "id": 3.4,
          "title": "Verify directory structure",
          "description": "Confirmed new directory structure matches the approved plan",
          "details": "Used `ls -R .` from within `apps/portal/convex/` to verify the structure. All newly created directories (`admin`, `auth`, `core/`, `core/lib/`, `core/schema/`, `downloads/`, `ecommerce/`, `ecommerce/lib/`, `ecommerce/schema/`, `lms/`, `shared/`) are present as per the plan from Task 2. Existing directories were preserved.",
          "status": "completed"
        }
      ]
    },
    {
      "id": 4,
      "title": "Refactor Schema Definitions",
      "description": "Move and reorganize schema definitions into feature-specific directories",
      "details": "1. Identify all schema definitions in the current structure.\n2. Move schema definitions to their respective feature directories (e.g., ecommerce/schema/, users/users.schema.ts).\n3. Update the main schema.ts to import and aggregate schemas from feature-specific files.\n4. Ensure all schema definitions follow Convex best practices, including appropriate indexing.\n5. Use the latest Convex SDK version (currently @convex-dev/server@0.3.0) for schema definitions.",
      "testStrategy": "Run Convex schema validation commands. Ensure all existing queries and mutations still work with the new schema structure.",
      "priority": "high",
      "dependencies": [
        3
      ],
      "status": "done",
      "subtasks": []
    },
    {
      "id": 5,
      "title": "Implement Shared Utility Functions",
      "description": "Create a shared utilities directory and implement common helper functions",
      "details": "1. Create a shared/ or utils/ directory at the root of convex/.\n2. Implement utility functions for common operations (e.g., pagination, validation helpers).\n3. Create a constants.ts file for shared constants across features.\n4. Implement getAuthenticatedUserId helper to standardize user authentication.\n5. Use TypeScript for strong typing and consider using utility types from @convex-dev/server.\n6. Export utilities through an index.ts file for easy importing.",
      "testStrategy": "Write unit tests for each utility function using a testing framework compatible with Convex (e.g., Jest with appropriate mocking of Convex context).",
      "priority": "high",
      "dependencies": [
        3
      ],
      "status": "done",
      "subtasks": []
    },
    {
      "id": 6,
      "title": "Refactor User Authentication and Authorization",
      "description": "Standardize user authentication and permission checking across the backend",
      "details": "1. Implement or update hasPermission and requirePermission utilities in permissions/lib/.\n2. Ensure all functions requiring authentication use the getAuthenticatedUserId helper.\n3. Replace direct calls to ctx.auth.getUserIdentity() with the standardized helper.\n4. Update all permission checks to use hasPermission or requirePermission utilities.\n5. Implement role-based access control using Convex's access control features if not already in place.",
      "testStrategy": "Create a comprehensive test suite for authentication and authorization, covering various user roles and permission scenarios.",
      "priority": "high",
      "dependencies": [
        5
      ],
      "status": "done",
      "subtasks": []
    },
    {
      "id": 7,
      "title": "Refactor E-commerce Module",
      "description": "Reorganize and refactor e-commerce related functions into the new structure",
      "details": "1. Create ecommerce/ directory with subdirectories for cart, checkout, orders, products, and variations.\n2. Move relevant queries, mutations, and actions to appropriate files.\n3. Update internal references (api.*, internal.*) to reflect new file locations.\n4. Extract common e-commerce logic into shared helper functions in ecommerce/lib/.\n5. Ensure consistent use of TypeScript types and Convex validators.\n6. Implement proper error handling with specific, informative error messages.",
      "testStrategy": "Develop a set of integration tests covering key e-commerce flows (add to cart, checkout, order placement). Ensure all existing functionality remains intact.",
      "priority": "medium",
      "dependencies": [
        4,
        5,
        6
      ],
      "status": "done",
      "subtasks": []
    },
    {
      "id": 8,
      "title": "Refactor Learning Management System (LMS) Module",
      "description": "Reorganize and refactor LMS related functions into the new structure",
      "details": "1. Create lms/ directory with files for courses, topics, and enrollments.\n2. Move relevant queries, mutations, and actions to appropriate files.\n3. Update internal references (api.*, internal.*) to reflect new file locations.\n4. Extract common LMS logic into shared helper functions in lms/lib/.\n5. Ensure consistent use of TypeScript types and Convex validators.\n6. Implement proper error handling with specific, informative error messages.",
      "testStrategy": "Develop integration tests covering key LMS flows (course creation, enrollment, progress tracking). Verify that all existing LMS functionality remains intact.",
      "priority": "medium",
      "dependencies": [
        4,
        5,
        6
      ],
      "status": "done",
      "subtasks": []
    },
    {
      "id": 9,
      "title": "Refactor User Management Module",
      "description": "Reorganize and refactor user management related functions into the new structure",
      "details": "1. Create users/ directory with users.ts and users.schema.ts.\n2. Move relevant queries, mutations, and actions to users.ts.\n3. Update internal references (api.*, internal.*) to reflect new file locations.\n4. Extract common user management logic into shared helper functions in users/lib/.\n5. Ensure consistent use of TypeScript types and Convex validators.\n6. Implement proper error handling with specific, informative error messages.\n7. Ensure all user-related operations use the standardized authentication and authorization helpers.",
      "testStrategy": "Develop comprehensive unit and integration tests for user management operations (create, read, update, delete). Verify proper handling of edge cases and error conditions.",
      "priority": "high",
      "dependencies": [
        4,
        5,
        6
      ],
      "status": "done",
      "subtasks": []
    },
    {
      "id": 10,
      "title": "Refactor Groups and Posts Module",
      "description": "Reorganize and refactor group and post related functions into the new structure",
      "details": "1. Create groups/ directory with files for groups and posts.\n2. Move relevant queries, mutations, and actions to appropriate files.\n3. Update internal references (api.*, internal.*) to reflect new file locations.\n4. Extract common group and post logic into shared helper functions in groups/lib/.\n5. Ensure consistent use of TypeScript types and Convex validators.\n6. Implement proper error handling with specific, informative error messages.\n7. Use Convex's pagination helpers for efficient list queries.",
      "testStrategy": "Develop integration tests covering group creation, joining, posting, and retrieval operations. Ensure proper handling of permissions and pagination.",
      "priority": "medium",
      "dependencies": [
        4,
        5,
        6
      ],
      "status": "done",
      "subtasks": []
    },
    {
      "id": 11,
      "title": "Refactor Downloads Module",
      "description": "Reorganize and refactor download related functions into the new structure",
      "details": "1. Create downloads/ directory with downloads.ts and downloads.schema.ts.\n2. Move relevant queries, mutations, and actions to downloads.ts.\n3. Update internal references (api.*, internal.*) to reflect new file locations.\n4. Extract common download logic into shared helper functions in downloads/lib/.\n5. Ensure consistent use of TypeScript types and Convex validators.\n6. Implement proper error handling with specific, informative error messages.\n7. Use Convex's file storage API for managing downloadable files if applicable.",
      "testStrategy": "Develop tests for download creation, retrieval, and access control. Verify proper handling of large files and concurrent downloads.",
      "priority": "medium",
      "dependencies": [
        4,
        5,
        6
      ],
      "status": "done",
      "subtasks": []
    },
    {
      "id": 12,
      "title": "Refactor Calendar Module",
      "description": "Reorganize and refactor calendar and event related functions into the new structure",
      "details": "1. Create calendar/ directory with files for calendar and events.\n2. Move relevant queries, mutations, and actions to appropriate files.\n3. Update internal references (api.*, internal.*) to reflect new file locations.\n4. Extract common calendar logic into shared helper functions in calendar/lib/.\n5. Ensure consistent use of TypeScript types and Convex validators.\n6. Implement proper error handling with specific, informative error messages.\n7. Use efficient querying techniques for date-based data retrieval.",
      "testStrategy": "Develop integration tests for event creation, retrieval, and calendar views. Ensure proper handling of time zones and recurring events if applicable.",
      "priority": "medium",
      "dependencies": [
        4,
        5,
        6
      ],
      "status": "done",
      "subtasks": []
    },
    {
      "id": 13,
      "title": "Refactor Notifications Module",
      "description": "Reorganize and refactor notification related functions into the new structure",
      "details": "1. Create notifications/ directory with notifications.ts and notifications.schema.ts.\n2. Move relevant queries, mutations, and actions to notifications.ts.\n3. Update internal references (api.*, internal.*) to reflect new file locations.\n4. Extract common notification logic into shared helper functions in notifications/lib/.\n5. Ensure consistent use of TypeScript types and Convex validators.\n6. Implement proper error handling with specific, informative error messages.\n7. Consider implementing a pub/sub pattern for real-time notifications using Convex's real-time features.",
      "testStrategy": "Develop tests for notification creation, delivery, and read status updates. Verify real-time delivery and proper handling of notification preferences.",
      "priority": "medium",
      "dependencies": [
        4,
        5,
        6
      ],
      "status": "done",
      "subtasks": []
    },
    {
      "id": 14,
      "title": "Refactor Content Management System (CMS) Module",
      "description": "Reorganize and refactor CMS related functions into the new structure",
      "details": "1. Create cms/ directory with files for posts and potentially other content types.\n2. Move relevant queries, mutations, and actions to appropriate files.\n3. Update internal references (api.*, internal.*) to reflect new file locations.\n4. Extract common CMS logic into shared helper functions in cms/lib/.\n5. Ensure consistent use of TypeScript types and Convex validators.\n6. Implement proper error handling with specific, informative error messages.\n7. Use Convex's search capabilities for content discovery if applicable.",
      "testStrategy": "Develop integration tests for content creation, editing, publishing, and retrieval. Verify proper handling of different content types and search functionality.",
      "priority": "medium",
      "dependencies": [
        4,
        5,
        6
      ],
      "status": "done",
      "subtasks": []
    },
    {
      "id": 15,
      "title": "Implement Consistent Error Handling",
      "description": "Establish and apply consistent error handling patterns across all modules",
      "details": "1. Create a shared error handling utility in the shared/ directory.\n2. Define custom error classes for different types of errors (e.g., ValidationError, NotFoundError, PermissionError).\n3. Implement a centralized error logging mechanism.\n4. Update all functions to use the new error handling utilities.\n5. Ensure all errors provide informative messages suitable for debugging.\n6. Implement proper error translation for client-side consumption.",
      "testStrategy": "Develop a comprehensive test suite that triggers various error conditions across all modules. Verify that errors are consistently handled and properly logged.",
      "priority": "high",
      "dependencies": [
        7,
        8,
        9,
        10,
        11,
        12,
        13,
        14
      ],
      "status": "done",
      "subtasks": []
    },
    {
      "id": 16,
      "title": "Implement Consistent Naming Conventions",
      "description": "Apply consistent naming conventions across all Convex functions and files",
      "status": "done",
      "dependencies": [
        7,
        8,
        9,
        10,
        11,
        12,
        13,
        14
      ],
      "priority": "medium",
      "details": "1. Establish naming conventions for queries (e.g., getResource, listResources, searchResources), mutations (e.g., createResource, updateResource, deleteResource), and actions (e.g., processPaymentAction).\n2. Update all function names to adhere to the established conventions.\n3. Ensure file names reflect their contents and follow a consistent pattern (queries.ts, mutations.ts, schema/types.ts, lib/helpers.ts).\n4. Update all internal references (api.*, internal.*) to reflect any name changes.\n5. Document the naming conventions in a central location for future reference.\n6. Create appropriate schema/types.ts files for each module to ensure proper TypeScript typing.\n7. Add backward compatibility exports where necessary to maintain existing functionality.",
      "testStrategy": "Conduct a thorough code review to ensure all names adhere to the new conventions. Use a linting tool if possible to automate some of the checks. Test functionality after each module update to ensure name changes don't break existing features. Verify that TypeScript typing is correctly implemented across all modules. Ensure backward compatibility exports work correctly for existing code.",
      "subtasks": [
        {
          "id": 16.1,
          "title": "Create NAMING_CONVENTIONS.md documentation",
          "description": "Document standardized naming conventions for Convex functions and files in a central location",
          "status": "done"
        },
        {
          "id": 16.2,
          "title": "Update notifications module",
          "description": "Rename query functions to use appropriate prefixes (list*, get*, count*), rename mutation functions to use appropriate prefixes (create*, update*, mark*, delete*), add types/interfaces, and fix component references",
          "status": "done"
        },
        {
          "id": 16.3,
          "title": "Update downloads module",
          "description": "Add new query functions with appropriate naming (listDownloads, listDownloadsByCategory, searchDownloads, getDownload)",
          "status": "done"
        },
        {
          "id": 16.4,
          "title": "Fix TypeScript/linter errors in downloads module",
          "description": "Resolve any TypeScript or linter errors that resulted from renaming functions in the downloads module, particularly around database schema typing",
          "status": "done"
        },
        {
          "id": 16.5,
          "title": "Update users module",
          "description": "Apply naming conventions to all functions in the users module, create proper file structure (queries.ts, mutations.ts, schema/types.ts, lib/helpers.ts), and update references",
          "status": "done"
        },
        {
          "id": 16.6,
          "title": "Update groups module",
          "description": "Apply naming conventions to all functions in the groups module, create proper file structure (queries.ts, mutations.ts, schema/types.ts, lib/helpers.ts), and update references",
          "status": "done"
        },
        {
          "id": 16.7,
          "title": "Update remaining modules",
          "description": "Apply naming conventions to any other modules not explicitly mentioned, ensuring proper file structure and TypeScript typing",
          "status": "done"
        },
        {
          "id": 16.8,
          "title": "Verify internal references",
          "description": "Ensure all internal references (api.*, internal.*) correctly reflect the name changes",
          "status": "done"
        },
        {
          "id": 16.9,
          "title": "Test functionality",
          "description": "Perform comprehensive testing to ensure the name changes haven't broken any existing functionality",
          "status": "done"
        },
        {
          "id": 17.9,
          "title": "Restructured downloads module",
          "description": "Reorganized downloads module with proper file structure, renamed functions, and added TypeScript interfaces",
          "details": "",
          "status": "done",
          "dependencies": [],
          "parentTaskId": 16
        },
        {
          "id": 16.11,
          "title": "Document implementation progress",
          "description": "Update project documentation to reflect the progress made on implementing naming conventions across modules",
          "status": "done"
        },
        {
          "id": 18.9,
          "title": "Refactored users module",
          "description": "Reorganized users module with proper file structure, renamed functions, and added TypeScript interfaces",
          "details": "",
          "status": "done",
          "dependencies": [],
          "parentTaskId": 16
        },
        {
          "id": 19.9,
          "title": "Refactored groups module",
          "description": "Reorganized groups module with proper file structure, renamed functions, and added TypeScript interfaces",
          "details": "",
          "status": "done",
          "dependencies": [],
          "parentTaskId": 16
        },
        {
          "id": 16.12,
          "title": "Verify backward compatibility exports",
          "description": "Ensure that backward compatibility exports in the users and groups modules are working correctly",
          "status": "done"
        },
        {
          "id": 16.13,
          "title": "Update NAMING_CONVENTIONS.md with examples",
          "description": "Add concrete examples from the completed modules to the naming conventions documentation",
          "status": "done"
        }
      ]
    },
    {
      "id": 17,
      "title": "Implement Consistent Use of TypeScript and Convex Validators",
      "description": "Ensure consistent and correct use of TypeScript types and Convex validators across all functions",
      "details": "1. Review and update all function signatures to use proper TypeScript types.\n2. Ensure consistent use of Convex types (e.g., Doc, Id) from @convex-dev/server.\n3. Implement or update args and returns validators for all Convex functions.\n4. Use v.union() for fields that can have multiple types.\n5. Implement custom validators for complex data structures if needed.\n6. Ensure null checks are properly handled, using v.optional() where appropriate.",
      "testStrategy": "Use TypeScript compiler in strict mode to catch type errors. Develop unit tests that pass various valid and invalid inputs to each function to verify proper validation.",
      "priority": "high",
      "dependencies": [
        7,
        8,
        9,
        10,
        11,
        12,
        13,
        14
      ],
      "status": "done",
      "subtasks": []
    },
    {
      "id": 18,
      "title": "Optimize Database Queries and Indexing",
      "description": "Review and optimize database queries, ensuring proper indexing for performance",
      "details": "1. Review all database queries for efficiency.\n2. Ensure proper indexing is in place for frequently queried fields.\n3. Use Convex's query() function with appropriate filters to optimize data retrieval.\n4. Implement pagination for large data sets using Convex's paginationOpts.\n5. Use Convex's withIndex() for queries that can benefit from specific indexes.\n6. Consider implementing caching strategies for frequently accessed, rarely changing data.\n7. Use Convex's query analyzer to identify slow queries and optimize them.",
      "testStrategy": "Develop performance tests for key database operations. Use Convex's built-in performance monitoring tools to measure query execution times before and after optimization.",
      "priority": "high",
      "dependencies": [
        4,
        7,
        8,
        9,
        10,
        11,
        12,
        13,
        14
      ],
      "status": "in-progress",
      "subtasks": []
    },
    {
      "id": 19,
      "title": "Update Frontend References",
      "description": "Update frontend code to reflect changes in Convex function paths and names",
      "details": "1. Identify all places in the frontend code (apps/portal/src/) where Convex functions are called.\n2. Update import statements to reflect the new directory structure.\n3. Update function names in useQuery, useMutation, and useAction hooks.\n4. Ensure all TypeScript types used in the frontend are updated to match backend changes.\n5. Update any hardcoded strings referring to Convex function paths.\n6. Verify that all Convex client interactions are using the latest patterns and best practices.",
      "testStrategy": "Run the frontend build process to catch any TypeScript errors. Manually test all major frontend flows to ensure proper communication with the refactored backend.",
      "priority": "high",
      "dependencies": [
        7,
        8,
        9,
        10,
        11,
        12,
        13,
        14,
        16
      ],
      "status": "done",
      "subtasks": []
    },
    {
      "id": 20,
      "title": "Develop Comprehensive Testing Suite",
      "description": "Create a comprehensive testing suite covering all refactored modules",
      "details": "1. Set up a testing framework compatible with Convex (e.g., Jest with appropriate mocking).\n2. Develop unit tests for all utility functions and helpers.\n3. Create integration tests covering key flows in each module (e.g., user registration, product purchase, course enrollment).\n4. Implement end-to-end tests for critical user journeys.\n5. Set up CI/CD pipeline to run tests automatically on each commit.\n6. Ensure proper mocking of Convex context and database operations in tests.\n7. Aim for high test coverage, particularly for core business logic.\n8. Document the testing strategy and how to run tests locally.",
      "testStrategy": "Run the entire test suite and verify that all tests pass. Use a code coverage tool to ensure adequate coverage across all modules.",
      "priority": "high",
      "dependencies": [
        15,
        16,
        17,
        18,
        19
      ],
      "status": "pending",
      "subtasks": []
    }
  ]
}