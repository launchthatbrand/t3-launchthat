{"version":3,"file":"index.js","names":["React","useEffect","useRef","useRouteTransition","transitionDuration","baseClass","initialDelay","ProgressBar","isTransitioning","transitionProgress","progressToShow","setProgressToShow","useState","shouldDelayProgress","clearTimerID","delayTimerID","current","setTimeout","clearTimeout","_jsx","className","filter","Boolean","join","style","width"],"sources":["../../../../src/providers/RouteTransition/ProgressBar/index.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useRef } from \"react\";\n\nimport { useRouteTransition } from \"../index.js\";\n\nimport \"./index.scss\";\n\nconst transitionDuration = 200;\nconst baseClass = \"progress-bar\";\nconst initialDelay = 150;\n\n/**\n * Renders a progress bar that shows the progress of a route transition.\n * Place this at the root of your application, inside of the `RouteTransitionProvider`.\n * When a transition is triggered, the progress bar will show the progress of that transition and exit when the transition is complete.\n * @returns A progress bar that shows the progress of a route transition\n * @example\n * import { RouteTransitionProvider, ProgressBar, Link } from '@convexcms/ui'\n * const App = () => (\n * <RouteTransitionProvider>\n *  <ProgressBar />\n *  <Link href=\"/somewhere\">Go Somewhere</Link>\n * </RouteTransitionProvider>\n */\nexport const ProgressBar = () => {\n  const { isTransitioning, transitionProgress } = useRouteTransition();\n  const [progressToShow, setProgressToShow] = React.useState<null | number>(\n    null,\n  );\n  const shouldDelayProgress = useRef(true);\n\n  useEffect(() => {\n    let clearTimerID: NodeJS.Timeout;\n    let delayTimerID: NodeJS.Timeout;\n\n    if (isTransitioning) {\n      if (shouldDelayProgress.current) {\n        delayTimerID = setTimeout(() => {\n          setProgressToShow(transitionProgress);\n          shouldDelayProgress.current = false;\n        }, initialDelay);\n      } else {\n        setProgressToShow(transitionProgress);\n      }\n    } else {\n      shouldDelayProgress.current = true;\n\n      // Fast forward to 100% when the transition is complete\n      // Then fade out the progress bar directly after\n      setProgressToShow(1);\n\n      // Wait for CSS transition to finish before hiding the progress bar\n      // This includes both the fast-forward to 100% and the subsequent fade-out\n      clearTimerID = setTimeout(() => {\n        setProgressToShow(null);\n      }, transitionDuration * 2);\n    }\n\n    return () => {\n      clearTimeout(clearTimerID);\n      clearTimeout(delayTimerID);\n    };\n  }, [isTransitioning, transitionProgress]);\n\n  if (typeof progressToShow === \"number\") {\n    return (\n      <div\n        className={[baseClass, progressToShow === 1 && `${baseClass}--fade-out`]\n          .filter(Boolean)\n          .join(\" \")}\n        style={{\n          // @ts-expect-error - TS doesn't like custom CSS properties\n          \"--transition-duration\": `${transitionDuration}ms`,\n        }}\n      >\n        <div\n          className={`${baseClass}__progress`}\n          style={{\n            width: `${(progressToShow || 0) * 100}%`,\n          }}\n        />\n      </div>\n    );\n  }\n\n  return null;\n};\n"],"mappings":"AAAA;;;AAEA,OAAOA,KAAA,IAASC,SAAS,EAAEC,MAAM,QAAQ;AAEzC,SAASC,kBAAkB,QAAQ;AAEnC,OAAO;AAEP,MAAMC,kBAAA,GAAqB;AAC3B,MAAMC,SAAA,GAAY;AAClB,MAAMC,YAAA,GAAe;AAErB;;;;;;;;;;;;;AAaA,OAAO,MAAMC,WAAA,GAAcA,CAAA;EACzB,MAAM;IAAEC,eAAe;IAAEC;EAAkB,CAAE,GAAGN,kBAAA;EAChD,MAAM,CAACO,cAAA,EAAgBC,iBAAA,CAAkB,GAAGX,KAAA,CAAMY,QAAQ,CACxD;EAEF,MAAMC,mBAAA,GAAsBX,MAAA,CAAO;EAEnCD,SAAA,CAAU;IACR,IAAIa,YAAA;IACJ,IAAIC,YAAA;IAEJ,IAAIP,eAAA,EAAiB;MACnB,IAAIK,mBAAA,CAAoBG,OAAO,EAAE;QAC/BD,YAAA,GAAeE,UAAA,CAAW;UACxBN,iBAAA,CAAkBF,kBAAA;UAClBI,mBAAA,CAAoBG,OAAO,GAAG;QAChC,GAAGV,YAAA;MACL,OAAO;QACLK,iBAAA,CAAkBF,kBAAA;MACpB;IACF,OAAO;MACLI,mBAAA,CAAoBG,OAAO,GAAG;MAE9B;MACA;MACAL,iBAAA,CAAkB;MAElB;MACA;MACAG,YAAA,GAAeG,UAAA,CAAW;QACxBN,iBAAA,CAAkB;MACpB,GAAGP,kBAAA,GAAqB;IAC1B;IAEA,OAAO;MACLc,YAAA,CAAaJ,YAAA;MACbI,YAAA,CAAaH,YAAA;IACf;EACF,GAAG,CAACP,eAAA,EAAiBC,kBAAA,CAAmB;EAExC,IAAI,OAAOC,cAAA,KAAmB,UAAU;IACtC,oBACES,IAAA,CAAC;MACCC,SAAA,EAAW,CAACf,SAAA,EAAWK,cAAA,KAAmB,KAAK,GAAGL,SAAA,YAAqB,CAAC,CACrEgB,MAAM,CAACC,OAAA,EACPC,IAAI,CAAC;MACRC,KAAA,EAAO;QACL;QACA,yBAAyB,GAAGpB,kBAAA;MAC9B;gBAEA,aAAAe,IAAA,CAAC;QACCC,SAAA,EAAW,GAAGf,SAAA,YAAqB;QACnCmB,KAAA,EAAO;UACLC,KAAA,EAAO,GAAG,CAACf,cAAA,IAAkB,KAAK;QACpC;;;EAIR;EAEA,OAAO;AACT","ignoreList":[]}