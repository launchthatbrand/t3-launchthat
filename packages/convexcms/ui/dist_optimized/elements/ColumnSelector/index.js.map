{"version":3,"file":"index.js","names":["React","useId","useMemo","fieldIsHiddenOrDisabled","fieldIsID","FieldLabel","PlusIcon","XIcon","useEditDepth","useTableColumns","DraggableSortable","Pill","baseClass","ColumnSelector","collectionSlug","columns","moveColumn","toggleColumn","uuid","editDepth","filteredColumns","filter","col","field","admin","disableListColumn","_jsx","className","ids","map","accessor","onDragEnd","moveFromIndex","moveToIndex","fromIndex","toIndex","i","active","alignIcon","Boolean","join","draggable","icon","id","onClick","CustomLabel","label","unstyled","name"],"sources":["../../../src/elements/ColumnSelector/index.tsx"],"sourcesContent":["\"use client\";\n\nimport \"./index.scss\";\n\nimport type { SanitizedCollectionConfig } from \"@convexcms/core\";\nimport React, { useId, useMemo } from \"react\";\nimport { fieldIsHiddenOrDisabled, fieldIsID } from \"@convexcms/core/shared\";\n\nimport { FieldLabel } from \"../../fields/FieldLabel/index.js\";\nimport { PlusIcon } from \"../../icons/Plus/index.js\";\nimport { XIcon } from \"../../icons/X/index.js\";\nimport { useEditDepth } from \"../../providers/EditDepth/index.js\";\nimport { useTableColumns } from \"../../providers/TableColumns/index.js\";\nimport { DraggableSortable } from \"../DraggableSortable/index.js\";\nimport { Pill } from \"../Pill/index.js\";\n\nconst baseClass = \"column-selector\";\n\nexport type Props = {\n  readonly collectionSlug: SanitizedCollectionConfig[\"slug\"];\n};\n\nexport const ColumnSelector: React.FC<Props> = ({ collectionSlug }) => {\n  const { columns, moveColumn, toggleColumn } = useTableColumns();\n\n  const uuid = useId();\n  const editDepth = useEditDepth();\n\n  const filteredColumns = useMemo(\n    () =>\n      columns.filter(\n        (col) =>\n          !(fieldIsHiddenOrDisabled(col.field) && !fieldIsID(col.field)) &&\n          !col?.field?.admin?.disableListColumn,\n      ),\n    [columns],\n  );\n\n  if (!columns) {\n    return null;\n  }\n\n  return (\n    <DraggableSortable\n      className={baseClass}\n      ids={filteredColumns.map((col) => col?.accessor)}\n      onDragEnd={({ moveFromIndex, moveToIndex }) => {\n        void moveColumn({\n          fromIndex: moveFromIndex,\n          toIndex: moveToIndex,\n        });\n      }}\n    >\n      {filteredColumns.map((col, i) => {\n        const { accessor, active, field } = col;\n\n        return (\n          <Pill\n            alignIcon=\"left\"\n            aria-checked={active}\n            className={[\n              `${baseClass}__column`,\n              active && `${baseClass}__column--active`,\n            ]\n              .filter(Boolean)\n              .join(\" \")}\n            draggable\n            icon={active ? <XIcon /> : <PlusIcon />}\n            id={accessor}\n            key={`${collectionSlug}-${field && \"name\" in field ? field?.name : i}${editDepth ? `-${editDepth}-` : \"\"}${uuid}`}\n            onClick={() => {\n              void toggleColumn(accessor);\n            }}\n          >\n            {col.CustomLabel ?? (\n              <FieldLabel\n                label={field && \"label\" in field && field.label}\n                unstyled\n              />\n            )}\n          </Pill>\n        );\n      })}\n    </DraggableSortable>\n  );\n};\n"],"mappings":"AAAA;;;AAEA,OAAO;AAGP,OAAOA,KAAA,IAASC,KAAK,EAAEC,OAAO,QAAQ;AACtC,SAASC,uBAAuB,EAAEC,SAAS,QAAQ;AAEnD,SAASC,UAAU,QAAQ;AAC3B,SAASC,QAAQ,QAAQ;AACzB,SAASC,KAAK,QAAQ;AACtB,SAASC,YAAY,QAAQ;AAC7B,SAASC,eAAe,QAAQ;AAChC,SAASC,iBAAiB,QAAQ;AAClC,SAASC,IAAI,QAAQ;AAErB,MAAMC,SAAA,GAAY;AAMlB,OAAO,MAAMC,cAAA,GAAkCA,CAAC;EAAEC;AAAc,CAAE;EAChE,MAAM;IAAEC,OAAO;IAAEC,UAAU;IAAEC;EAAY,CAAE,GAAGR,eAAA;EAE9C,MAAMS,IAAA,GAAOjB,KAAA;EACb,MAAMkB,SAAA,GAAYX,YAAA;EAElB,MAAMY,eAAA,GAAkBlB,OAAA,CACtB,MACEa,OAAA,CAAQM,MAAM,CACXC,GAAA,IACC,EAAEnB,uBAAA,CAAwBmB,GAAA,CAAIC,KAAK,KAAK,CAACnB,SAAA,CAAUkB,GAAA,CAAIC,KAAK,MAC5D,CAACD,GAAA,EAAKC,KAAA,EAAOC,KAAA,EAAOC,iBAAA,GAE1B,CAACV,OAAA,CAAQ;EAGX,IAAI,CAACA,OAAA,EAAS;IACZ,OAAO;EACT;EAEA,oBACEW,IAAA,CAAChB,iBAAA;IACCiB,SAAA,EAAWf,SAAA;IACXgB,GAAA,EAAKR,eAAA,CAAgBS,GAAG,CAAEP,GAAA,IAAQA,GAAA,EAAKQ,QAAA;IACvCC,SAAA,EAAWA,CAAC;MAAEC,aAAa;MAAEC;IAAW,CAAE;MACxC,KAAKjB,UAAA,CAAW;QACdkB,SAAA,EAAWF,aAAA;QACXG,OAAA,EAASF;MACX;IACF;cAECb,eAAA,CAAgBS,GAAG,CAAC,CAACP,GAAA,EAAKc,CAAA;MACzB,MAAM;QAAEN,QAAQ;QAAEO,MAAM;QAAEd;MAAK,CAAE,GAAGD,GAAA;MAEpC,oBACEI,IAAA,CAACf,IAAA;QACC2B,SAAA,EAAU;QACV,gBAAcD,MAAA;QACdV,SAAA,EAAW,CACT,GAAGf,SAAA,UAAmB,EACtByB,MAAA,IAAU,GAAGzB,SAAA,kBAA2B,CACzC,CACES,MAAM,CAACkB,OAAA,EACPC,IAAI,CAAC;QACRC,SAAS;QACTC,IAAA,EAAML,MAAA,gBAASX,IAAA,CAACnB,KAAA,qBAAWmB,IAAA,CAACpB,QAAA;QAC5BqC,EAAA,EAAIb,QAAA;QAEJc,OAAA,EAASA,CAAA;UACP,KAAK3B,YAAA,CAAaa,QAAA;QACpB;kBAECR,GAAA,CAAIuB,WAAW,iBACdnB,IAAA,CAACrB,UAAA;UACCyC,KAAA,EAAOvB,KAAA,IAAS,WAAWA,KAAA,IAASA,KAAA,CAAMuB,KAAK;UAC/CC,QAAQ;;SARP,GAAGjC,cAAA,IAAkBS,KAAA,IAAS,UAAUA,KAAA,GAAQA,KAAA,EAAOyB,IAAA,GAAOZ,CAAA,GAAIjB,SAAA,GAAY,IAAIA,SAAA,GAAY,GAAG,KAAKD,IAAA,EAAM;IAavH;;AAGN","ignoreList":[]}