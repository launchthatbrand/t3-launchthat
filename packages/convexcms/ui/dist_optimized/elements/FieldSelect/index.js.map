{"version":3,"file":"index.js","names":["React","useState","FieldLabel","useForm","useTranslation","filterOutUploadFields","ReactSelect","reduceFieldOptions","baseClass","FieldSelect","fields","onChange","permissions","t","dispatchFields","getFields","options","formState","_jsxs","className","_jsx","label","getOptionValue","option","value","String","path","isMulti","selected"],"sources":["../../../src/elements/FieldSelect/index.tsx"],"sourcesContent":["\"use client\";\n\nimport \"./index.scss\";\n\nimport type {\n  ClientField,\n  FormState,\n  SanitizedFieldPermissions,\n} from \"@convexcms/core\";\nimport React, { useState } from \"react\";\n\nimport type { FieldAction } from \"../../forms/Form/types.js\";\nimport type { FieldOption } from \"./reduceFieldOptions.js\";\nimport { FieldLabel } from \"../../fields/FieldLabel/index.js\";\nimport { useForm } from \"../../forms/Form/context.js\";\nimport { useTranslation } from \"../../providers/Translation/index.js\";\nimport { filterOutUploadFields } from \"../../utilities/filterOutUploadFields.js\";\nimport { ReactSelect } from \"../ReactSelect/index.js\";\nimport { reduceFieldOptions } from \"./reduceFieldOptions.js\";\n\nconst baseClass = \"field-select\";\n\nexport type OnFieldSelect = ({\n  dispatchFields,\n  formState,\n  selected,\n}: {\n  dispatchFields: React.Dispatch<FieldAction>;\n  formState: FormState;\n  selected: FieldOption[];\n}) => void;\n\nexport type FieldSelectProps = {\n  readonly fields: ClientField[];\n  readonly onChange: OnFieldSelect;\n  readonly permissions:\n    | {\n        [fieldName: string]: SanitizedFieldPermissions;\n      }\n    | SanitizedFieldPermissions;\n};\n\nexport const FieldSelect: React.FC<FieldSelectProps> = ({\n  fields,\n  onChange,\n  permissions,\n}) => {\n  const { t } = useTranslation();\n  const { dispatchFields, getFields } = useForm();\n\n  const [options] = useState<FieldOption[]>(() =>\n    reduceFieldOptions({\n      fields: filterOutUploadFields(fields),\n      formState: getFields(),\n      permissions,\n    }),\n  );\n\n  return (\n    <div className={baseClass}>\n      <FieldLabel label={t(\"fields:selectFieldsToEdit\")} />\n      <ReactSelect\n        getOptionValue={(option) => {\n          if (typeof option.value === \"object\" && \"path\" in option.value) {\n            return String(option.value.path);\n          }\n          return String(option.value);\n        }}\n        isMulti\n        onChange={(selected: FieldOption[]) =>\n          onChange({ dispatchFields, formState: getFields(), selected })\n        }\n        options={options}\n      />\n    </div>\n  );\n};\n"],"mappings":"AAAA;;;AAEA,OAAO;AAOP,OAAOA,KAAA,IAASC,QAAQ,QAAQ;AAIhC,SAASC,UAAU,QAAQ;AAC3B,SAASC,OAAO,QAAQ;AACxB,SAASC,cAAc,QAAQ;AAC/B,SAASC,qBAAqB,QAAQ;AACtC,SAASC,WAAW,QAAQ;AAC5B,SAASC,kBAAkB,QAAQ;AAEnC,MAAMC,SAAA,GAAY;AAsBlB,OAAO,MAAMC,WAAA,GAA0CA,CAAC;EACtDC,MAAM;EACNC,QAAQ;EACRC;AAAW,CACZ;EACC,MAAM;IAAEC;EAAC,CAAE,GAAGT,cAAA;EACd,MAAM;IAAEU,cAAc;IAAEC;EAAS,CAAE,GAAGZ,OAAA;EAEtC,MAAM,CAACa,OAAA,CAAQ,GAAGf,QAAA,CAAwB,MACxCM,kBAAA,CAAmB;IACjBG,MAAA,EAAQL,qBAAA,CAAsBK,MAAA;IAC9BO,SAAA,EAAWF,SAAA;IACXH;EACF;EAGF,oBACEM,KAAA,CAAC;IAAIC,SAAA,EAAWX,SAAA;4BACdY,IAAA,CAAClB,UAAA;MAAWmB,KAAA,EAAOR,CAAA,CAAE;qBACrBO,IAAA,CAACd,WAAA;MACCgB,cAAA,EAAiBC,MAAA;QACf,IAAI,OAAOA,MAAA,CAAOC,KAAK,KAAK,YAAY,UAAUD,MAAA,CAAOC,KAAK,EAAE;UAC9D,OAAOC,MAAA,CAAOF,MAAA,CAAOC,KAAK,CAACE,IAAI;QACjC;QACA,OAAOD,MAAA,CAAOF,MAAA,CAAOC,KAAK;MAC5B;MACAG,OAAO;MACPhB,QAAA,EAAWiB,QAAA,IACTjB,QAAA,CAAS;QAAEG,cAAA;QAAgBG,SAAA,EAAWF,SAAA;QAAaa;MAAS;MAE9DZ,OAAA,EAASA;;;AAIjB","ignoreList":[]}