{"version":3,"file":"index.js","names":["React","getTranslation","useTranslation","ReactSelect","formatOptions","Select","disabled","isClearable","onChange","operator","options","optionsFromProps","value","i18n","setOptions","useState","isMulti","includes","valueToRender","Array","isArray","map","val","matchingOption","find","option","label","onSelect","useCallback","selectedOption","newValue","useEffect","_jsx"],"sources":["../../../../../src/elements/WhereBuilder/Condition/Select/index.tsx"],"sourcesContent":["\"use client\";\n\nimport React from \"react\";\nimport { getTranslation } from \"@convexcms/translations\";\n\nimport type { Props } from \"./types.js\";\nimport { useTranslation } from \"../../../../providers/Translation/index.js\";\nimport { ReactSelect } from \"../../../ReactSelect/index.js\";\nimport { formatOptions } from \"./formatOptions.js\";\n\nexport const Select: React.FC<Props> = ({\n  disabled,\n  isClearable,\n  onChange,\n  operator,\n  options: optionsFromProps,\n  value,\n}) => {\n  const { i18n } = useTranslation();\n  const [options, setOptions] = React.useState(formatOptions(optionsFromProps));\n\n  const isMulti = [\"in\", \"not_in\"].includes(operator);\n  let valueToRender;\n\n  if (isMulti && Array.isArray(value)) {\n    valueToRender = value.map((val) => {\n      const matchingOption = options.find((option) => option.value === val);\n      return {\n        label: matchingOption\n          ? getTranslation(matchingOption.label, i18n)\n          : val,\n        value: matchingOption?.value ?? val,\n      };\n    });\n  } else if (value) {\n    const matchingOption = options.find((option) => option.value === value);\n    valueToRender = {\n      label: matchingOption\n        ? getTranslation(matchingOption.label, i18n)\n        : value,\n      value: matchingOption?.value ?? value,\n    };\n  }\n\n  const onSelect = React.useCallback(\n    (selectedOption) => {\n      let newValue;\n\n      if (!selectedOption) {\n        newValue = null;\n      } else if (isMulti) {\n        if (Array.isArray(selectedOption)) {\n          newValue = selectedOption.map((option) => option.value);\n        } else {\n          newValue = [];\n        }\n      } else {\n        newValue = selectedOption.value;\n      }\n\n      onChange(newValue);\n    },\n    [isMulti, onChange],\n  );\n\n  React.useEffect(() => {\n    setOptions(formatOptions(optionsFromProps));\n  }, [optionsFromProps]);\n\n  React.useEffect(() => {\n    if (!isMulti && Array.isArray(value)) {\n      onChange(value[0]);\n    }\n  }, [isMulti, onChange, value]);\n\n  return (\n    <ReactSelect\n      disabled={disabled}\n      isClearable={isClearable}\n      isMulti={isMulti}\n      onChange={onSelect}\n      options={options.map((option) => ({\n        ...option,\n        label: getTranslation(option.label, i18n),\n      }))}\n      value={valueToRender}\n    />\n  );\n};\n"],"mappings":"AAAA;;;AAEA,OAAOA,KAAA,MAAW;AAClB,SAASC,cAAc,QAAQ;AAG/B,SAASC,cAAc,QAAQ;AAC/B,SAASC,WAAW,QAAQ;AAC5B,SAASC,aAAa,QAAQ;AAE9B,OAAO,MAAMC,MAAA,GAA0BA,CAAC;EACtCC,QAAQ;EACRC,WAAW;EACXC,QAAQ;EACRC,QAAQ;EACRC,OAAA,EAASC,gBAAgB;EACzBC;AAAK,CACN;EACC,MAAM;IAAEC;EAAI,CAAE,GAAGX,cAAA;EACjB,MAAM,CAACQ,OAAA,EAASI,UAAA,CAAW,GAAGd,KAAA,CAAMe,QAAQ,CAACX,aAAA,CAAcO,gBAAA;EAE3D,MAAMK,OAAA,GAAU,CAAC,MAAM,SAAS,CAACC,QAAQ,CAACR,QAAA;EAC1C,IAAIS,aAAA;EAEJ,IAAIF,OAAA,IAAWG,KAAA,CAAMC,OAAO,CAACR,KAAA,GAAQ;IACnCM,aAAA,GAAgBN,KAAA,CAAMS,GAAG,CAAEC,GAAA;MACzB,MAAMC,cAAA,GAAiBb,OAAA,CAAQc,IAAI,CAAEC,MAAA,IAAWA,MAAA,CAAOb,KAAK,KAAKU,GAAA;MACjE,OAAO;QACLI,KAAA,EAAOH,cAAA,GACHtB,cAAA,CAAesB,cAAA,CAAeG,KAAK,EAAEb,IAAA,IACrCS,GAAA;QACJV,KAAA,EAAOW,cAAA,EAAgBX,KAAA,IAASU;MAClC;IACF;EACF,OAAO,IAAIV,KAAA,EAAO;IAChB,MAAMW,cAAA,GAAiBb,OAAA,CAAQc,IAAI,CAAEC,MAAA,IAAWA,MAAA,CAAOb,KAAK,KAAKA,KAAA;IACjEM,aAAA,GAAgB;MACdQ,KAAA,EAAOH,cAAA,GACHtB,cAAA,CAAesB,cAAA,CAAeG,KAAK,EAAEb,IAAA,IACrCD,KAAA;MACJA,KAAA,EAAOW,cAAA,EAAgBX,KAAA,IAASA;IAClC;EACF;EAEA,MAAMe,QAAA,GAAW3B,KAAA,CAAM4B,WAAW,CAC/BC,cAAA;IACC,IAAIC,QAAA;IAEJ,IAAI,CAACD,cAAA,EAAgB;MACnBC,QAAA,GAAW;IACb,OAAO,IAAId,OAAA,EAAS;MAClB,IAAIG,KAAA,CAAMC,OAAO,CAACS,cAAA,GAAiB;QACjCC,QAAA,GAAWD,cAAA,CAAeR,GAAG,CAAEI,MAAA,IAAWA,MAAA,CAAOb,KAAK;MACxD,OAAO;QACLkB,QAAA,GAAW,EAAE;MACf;IACF,OAAO;MACLA,QAAA,GAAWD,cAAA,CAAejB,KAAK;IACjC;IAEAJ,QAAA,CAASsB,QAAA;EACX,GACA,CAACd,OAAA,EAASR,QAAA,CAAS;EAGrBR,KAAA,CAAM+B,SAAS,CAAC;IACdjB,UAAA,CAAWV,aAAA,CAAcO,gBAAA;EAC3B,GAAG,CAACA,gBAAA,CAAiB;EAErBX,KAAA,CAAM+B,SAAS,CAAC;IACd,IAAI,CAACf,OAAA,IAAWG,KAAA,CAAMC,OAAO,CAACR,KAAA,GAAQ;MACpCJ,QAAA,CAASI,KAAK,CAAC,EAAE;IACnB;EACF,GAAG,CAACI,OAAA,EAASR,QAAA,EAAUI,KAAA,CAAM;EAE7B,oBACEoB,IAAA,CAAC7B,WAAA;IACCG,QAAA,EAAUA,QAAA;IACVC,WAAA,EAAaA,WAAA;IACbS,OAAA,EAASA,OAAA;IACTR,QAAA,EAAUmB,QAAA;IACVjB,OAAA,EAASA,OAAA,CAAQW,GAAG,CAAEI,MAAA,KAAY;MAChC,GAAGA,MAAM;MACTC,KAAA,EAAOzB,cAAA,CAAewB,MAAA,CAAOC,KAAK,EAAEb,IAAA;IACtC;IACAD,KAAA,EAAOM;;AAGb","ignoreList":[]}