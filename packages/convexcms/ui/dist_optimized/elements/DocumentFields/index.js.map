{"version":3,"file":"index.js","names":["React","useMemo","fieldIsSidebar","RenderFields","Gutter","baseClass","DocumentFields","AfterFields","BeforeFields","Description","docPermissions","fields","forceSidebarWrap","readOnly","schemaPathSegments","hasSidebarFields","mainFields","sidebarFields","reduce","acc","field","push","_jsxs","className","filter","Boolean","join","_jsx","forceRender","parentIndexPath","parentPath","parentSchemaPath","permissions"],"sources":["../../../src/elements/DocumentFields/index.tsx"],"sourcesContent":["\"use client\";\n\nimport \"./index.scss\";\n\nimport type {\n  ClientField,\n  SanitizedDocumentPermissions,\n} from \"@convexcms/core\";\nimport React, { useMemo } from \"react\";\nimport { fieldIsSidebar } from \"@convexcms/core/shared\";\n\nimport {\n  useFormInitializing,\n  useFormProcessing,\n} from \"../../forms/Form/context.js\";\nimport { RenderFields } from \"../../forms/RenderFields/index.js\";\nimport { Gutter } from \"../Gutter/index.js\";\n\nconst baseClass = \"document-fields\";\n\ntype Args = {\n  readonly AfterFields?: React.ReactNode;\n  readonly BeforeFields?: React.ReactNode;\n  readonly Description?: React.ReactNode;\n  readonly docPermissions: SanitizedDocumentPermissions;\n  readonly fields: ClientField[];\n  readonly forceSidebarWrap?: boolean;\n  readonly readOnly?: boolean;\n  readonly schemaPathSegments: string[];\n};\n\nexport const DocumentFields: React.FC<Args> = ({\n  AfterFields,\n  BeforeFields,\n  Description,\n  docPermissions,\n  fields,\n  forceSidebarWrap,\n  readOnly,\n  schemaPathSegments,\n}) => {\n  const { hasSidebarFields, mainFields, sidebarFields } = useMemo(() => {\n    return fields.reduce(\n      (acc, field) => {\n        if (fieldIsSidebar(field)) {\n          acc.sidebarFields.push(field);\n          acc.mainFields.push(null);\n          acc.hasSidebarFields = true;\n        } else {\n          acc.mainFields.push(field);\n          acc.sidebarFields.push(null);\n        }\n        return acc;\n      },\n      {\n        hasSidebarFields: false,\n        mainFields: [] as ClientField[],\n        sidebarFields: [] as ClientField[],\n      },\n    );\n  }, [fields]);\n\n  return (\n    <div\n      className={[\n        baseClass,\n        hasSidebarFields\n          ? `${baseClass}--has-sidebar`\n          : `${baseClass}--no-sidebar`,\n        forceSidebarWrap && `${baseClass}--force-sidebar-wrap`,\n      ]\n        .filter(Boolean)\n        .join(\" \")}\n    >\n      <div className={`${baseClass}__main`}>\n        <Gutter className={`${baseClass}__edit`}>\n          {Description ? (\n            <header className={`${baseClass}__header`}>\n              <div className={`${baseClass}__sub-header`}>{Description}</div>\n            </header>\n          ) : null}\n          {BeforeFields}\n          <RenderFields\n            className={`${baseClass}__fields`}\n            fields={mainFields}\n            forceRender\n            parentIndexPath=\"\"\n            parentPath=\"\"\n            parentSchemaPath={schemaPathSegments.join(\".\")}\n            permissions={docPermissions?.fields}\n            readOnly={readOnly}\n          />\n          {AfterFields}\n        </Gutter>\n      </div>\n      {hasSidebarFields ? (\n        <div className={`${baseClass}__sidebar-wrap`}>\n          <div className={`${baseClass}__sidebar`}>\n            <div className={`${baseClass}__sidebar-fields`}>\n              <RenderFields\n                fields={sidebarFields}\n                forceRender\n                parentIndexPath=\"\"\n                parentPath=\"\"\n                parentSchemaPath={schemaPathSegments.join(\".\")}\n                permissions={docPermissions?.fields}\n                readOnly={readOnly}\n              />\n            </div>\n          </div>\n        </div>\n      ) : null}\n    </div>\n  );\n};\n"],"mappings":"AAAA;;;AAEA,OAAO;AAMP,OAAOA,KAAA,IAASC,OAAO,QAAQ;AAC/B,SAASC,cAAc,QAAQ;AAM/B,SAASC,YAAY,QAAQ;AAC7B,SAASC,MAAM,QAAQ;AAEvB,MAAMC,SAAA,GAAY;AAalB,OAAO,MAAMC,cAAA,GAAiCA,CAAC;EAC7CC,WAAW;EACXC,YAAY;EACZC,WAAW;EACXC,cAAc;EACdC,MAAM;EACNC,gBAAgB;EAChBC,QAAQ;EACRC;AAAkB,CACnB;EACC,MAAM;IAAEC,gBAAgB;IAAEC,UAAU;IAAEC;EAAa,CAAE,GAAGhB,OAAA,CAAQ;IAC9D,OAAOU,MAAA,CAAOO,MAAM,CAClB,CAACC,GAAA,EAAKC,KAAA;MACJ,IAAIlB,cAAA,CAAekB,KAAA,GAAQ;QACzBD,GAAA,CAAIF,aAAa,CAACI,IAAI,CAACD,KAAA;QACvBD,GAAA,CAAIH,UAAU,CAACK,IAAI,CAAC;QACpBF,GAAA,CAAIJ,gBAAgB,GAAG;MACzB,OAAO;QACLI,GAAA,CAAIH,UAAU,CAACK,IAAI,CAACD,KAAA;QACpBD,GAAA,CAAIF,aAAa,CAACI,IAAI,CAAC;MACzB;MACA,OAAOF,GAAA;IACT,GACA;MACEJ,gBAAA,EAAkB;MAClBC,UAAA,EAAY,EAAE;MACdC,aAAA,EAAe;IACjB;EAEJ,GAAG,CAACN,MAAA,CAAO;EAEX,oBACEW,KAAA,CAAC;IACCC,SAAA,EAAW,CACTlB,SAAA,EACAU,gBAAA,GACI,GAAGV,SAAA,eAAwB,GAC3B,GAAGA,SAAA,cAAuB,EAC9BO,gBAAA,IAAoB,GAAGP,SAAA,sBAA+B,CACvD,CACEmB,MAAM,CAACC,OAAA,EACPC,IAAI,CAAC;4BAERC,IAAA,CAAC;MAAIJ,SAAA,EAAW,GAAGlB,SAAA,QAAiB;gBAClC,aAAAiB,KAAA,CAAClB,MAAA;QAAOmB,SAAA,EAAW,GAAGlB,SAAA,QAAiB;mBACpCI,WAAA,gBACCkB,IAAA,CAAC;UAAOJ,SAAA,EAAW,GAAGlB,SAAA,UAAmB;oBACvC,aAAAsB,IAAA,CAAC;YAAIJ,SAAA,EAAW,GAAGlB,SAAA,cAAuB;sBAAGI;;aAE7C,MACHD,YAAA,E,aACDmB,IAAA,CAACxB,YAAA;UACCoB,SAAA,EAAW,GAAGlB,SAAA,UAAmB;UACjCM,MAAA,EAAQK,UAAA;UACRY,WAAW;UACXC,eAAA,EAAgB;UAChBC,UAAA,EAAW;UACXC,gBAAA,EAAkBjB,kBAAA,CAAmBY,IAAI,CAAC;UAC1CM,WAAA,EAAatB,cAAA,EAAgBC,MAAA;UAC7BE,QAAA,EAAUA;YAEXN,WAAA;;QAGJQ,gBAAA,gBACCY,IAAA,CAAC;MAAIJ,SAAA,EAAW,GAAGlB,SAAA,gBAAyB;gBAC1C,aAAAsB,IAAA,CAAC;QAAIJ,SAAA,EAAW,GAAGlB,SAAA,WAAoB;kBACrC,aAAAsB,IAAA,CAAC;UAAIJ,SAAA,EAAW,GAAGlB,SAAA,kBAA2B;oBAC5C,aAAAsB,IAAA,CAACxB,YAAA;YACCQ,MAAA,EAAQM,aAAA;YACRW,WAAW;YACXC,eAAA,EAAgB;YAChBC,UAAA,EAAW;YACXC,gBAAA,EAAkBjB,kBAAA,CAAmBY,IAAI,CAAC;YAC1CM,WAAA,EAAatB,cAAA,EAAgBC,MAAA;YAC7BE,QAAA,EAAUA;;;;SAKhB;;AAGV","ignoreList":[]}