{"version":3,"file":"index.js","names":["React","getTranslation","useConfig","useTranslation","BlocksCell","cellData","field","blockReferences","blocks","labels","i18n","config","selectedBlocks","Array","isArray","map","blockType","translatedBlockLabels","b","block","blocksMap","slug","label","singular","plural","formatBlockList","filtered","filter","f","join","itemsToShow","length","more","t","count","items","slice","_jsx"],"sources":["../../../../../../src/elements/Table/DefaultCell/fields/Blocks/index.tsx"],"sourcesContent":["\"use client\";\n\nimport type {\n  BlocksFieldClient,\n  DefaultCellComponentProps,\n} from \"@convexcms/core\";\nimport React from \"react\";\nimport { getTranslation } from \"@convexcms/translations\";\n\nimport { useConfig } from \"../../../../../providers/Config/index.js\";\nimport { useTranslation } from \"../../../../../providers/Translation/index.js\";\n\nexport interface BlocksCellProps\n  extends DefaultCellComponentProps<BlocksFieldClient> {}\n\nexport const BlocksCell: React.FC<BlocksCellProps> = ({\n  cellData,\n  field: { blockReferences, blocks, labels },\n}) => {\n  const { i18n } = useTranslation();\n  const { config } = useConfig();\n\n  const selectedBlocks = Array.isArray(cellData)\n    ? cellData.map(({ blockType }) => blockType)\n    : [];\n\n  const translatedBlockLabels = (blockReferences ?? blocks)?.map((b) => {\n    const block = typeof b === \"string\" ? config.blocksMap[b] : b;\n    return {\n      slug: block.slug,\n      label: getTranslation(block.labels.singular, i18n),\n    };\n  });\n\n  let label = `0 ${getTranslation(labels?.plural, i18n)}`;\n\n  const formatBlockList = (blocks) =>\n    blocks\n      .map((b) => {\n        const filtered = translatedBlockLabels.filter((f) => f.slug === b)?.[0];\n        return filtered?.label;\n      })\n      .join(\", \");\n\n  const itemsToShow = 5;\n\n  if (selectedBlocks.length > itemsToShow) {\n    const more = selectedBlocks.length - itemsToShow;\n    label = `${selectedBlocks.length} ${getTranslation(labels?.plural, i18n)} - ${i18n.t(\n      \"fields:itemsAndMore\",\n      {\n        count: more,\n        items: formatBlockList(selectedBlocks.slice(0, itemsToShow)),\n      },\n    )}`;\n  } else if (selectedBlocks.length > 0) {\n    label = `${selectedBlocks.length} ${getTranslation(\n      selectedBlocks.length === 1 ? labels?.singular : labels?.plural,\n      i18n,\n    )} - ${formatBlockList(selectedBlocks)}`;\n  }\n\n  return <span>{label}</span>;\n};\n"],"mappings":"AAAA;;;AAMA,OAAOA,KAAA,MAAW;AAClB,SAASC,cAAc,QAAQ;AAE/B,SAASC,SAAS,QAAQ;AAC1B,SAASC,cAAc,QAAQ;AAK/B,OAAO,MAAMC,UAAA,GAAwCA,CAAC;EACpDC,QAAQ;EACRC,KAAA,EAAO;IAAEC,eAAe;IAAEC,MAAM;IAAEC;EAAM;AAAE,CAC3C;EACC,MAAM;IAAEC;EAAI,CAAE,GAAGP,cAAA;EACjB,MAAM;IAAEQ;EAAM,CAAE,GAAGT,SAAA;EAEnB,MAAMU,cAAA,GAAiBC,KAAA,CAAMC,OAAO,CAACT,QAAA,IACjCA,QAAA,CAASU,GAAG,CAAC,CAAC;IAAEC;EAAS,CAAE,KAAKA,SAAA,IAChC,EAAE;EAEN,MAAMC,qBAAA,GAAyB,CAAAV,eAAA,IAAmBC,MAAK,GAAIO,GAAA,CAAKG,CAAA;IAC9D,MAAMC,KAAA,GAAQ,OAAOD,CAAA,KAAM,WAAWP,MAAA,CAAOS,SAAS,CAACF,CAAA,CAAE,GAAGA,CAAA;IAC5D,OAAO;MACLG,IAAA,EAAMF,KAAA,CAAME,IAAI;MAChBC,KAAA,EAAOrB,cAAA,CAAekB,KAAA,CAAMV,MAAM,CAACc,QAAQ,EAAEb,IAAA;IAC/C;EACF;EAEA,IAAIY,KAAA,GAAQ,KAAKrB,cAAA,CAAeQ,MAAA,EAAQe,MAAA,EAAQd,IAAA,GAAO;EAEvD,MAAMe,eAAA,GAAmBjB,MAAA,IACvBA,MAAA,CACGO,GAAG,CAAEG,CAAA;IACJ,MAAMQ,QAAA,GAAWT,qBAAA,CAAsBU,MAAM,CAAEC,CAAA,IAAMA,CAAA,CAAEP,IAAI,KAAKH,CAAA,IAAK,EAAE;IACvE,OAAOQ,QAAA,EAAUJ,KAAA;EACnB,GACCO,IAAI,CAAC;EAEV,MAAMC,WAAA,GAAc;EAEpB,IAAIlB,cAAA,CAAemB,MAAM,GAAGD,WAAA,EAAa;IACvC,MAAME,IAAA,GAAOpB,cAAA,CAAemB,MAAM,GAAGD,WAAA;IACrCR,KAAA,GAAQ,GAAGV,cAAA,CAAemB,MAAM,IAAI9B,cAAA,CAAeQ,MAAA,EAAQe,MAAA,EAAQd,IAAA,OAAWA,IAAA,CAAKuB,CAAC,CAClF,uBACA;MACEC,KAAA,EAAOF,IAAA;MACPG,KAAA,EAAOV,eAAA,CAAgBb,cAAA,CAAewB,KAAK,CAAC,GAAGN,WAAA;IACjD,IACC;EACL,OAAO,IAAIlB,cAAA,CAAemB,MAAM,GAAG,GAAG;IACpCT,KAAA,GAAQ,GAAGV,cAAA,CAAemB,MAAM,IAAI9B,cAAA,CAClCW,cAAA,CAAemB,MAAM,KAAK,IAAItB,MAAA,EAAQc,QAAA,GAAWd,MAAA,EAAQe,MAAA,EACzDd,IAAA,OACKe,eAAA,CAAgBb,cAAA,GAAiB;EAC1C;EAEA,oBAAOyB,IAAA,CAAC;cAAMf;;AAChB","ignoreList":[]}