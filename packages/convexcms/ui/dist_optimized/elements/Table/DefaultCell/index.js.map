{"version":3,"file":"index.js","names":["React","fieldAffectsData","fieldIsID","getTranslation","useConfig","useTranslation","formatAdminURL","getDisplayedFieldValue","Link","CodeCell","cellComponents","DefaultCell","props","cellData","className","classNameFromProps","collectionSlug","field","admin","link","onClick","onClickFromProps","rowData","i18n","config","routes","adminRoute","getEntityConfig","collectionConfig","classNameFromConfigContext","undefined","WrapElement","wrapElementProps","prefetch","href","slug","path","encodeURIComponent","id","type","_jsx","nowrap","displayedValue","DefaultCellComponent","CellComponent","isValidElement","upload","name","FileCellComponent","File","_jsxs","t","label","JSON","stringify","options","length","classes","Array","isArray","map","value","join","filter","Boolean"],"sources":["../../../../src/elements/Table/DefaultCell/index.tsx"],"sourcesContent":["\"use client\";\n\nimport type {\n  DefaultCellComponentProps,\n  UploadFieldClient,\n} from \"@convexcms/core\";\nimport React from \"react\"; // TODO: abstract this out to support all routers\nimport { fieldAffectsData, fieldIsID } from \"@convexcms/core/shared\";\nimport { getTranslation } from \"@convexcms/translations\";\n\nimport { useConfig } from \"../../../providers/Config/index.js\";\nimport { useTranslation } from \"../../../providers/Translation/index.js\";\nimport { formatAdminURL } from \"../../../utilities/formatAdminURL.js\";\nimport { getDisplayedFieldValue } from \"../../../utilities/getDisplayedFieldValue.js\";\nimport { Link } from \"../../Link/index.js\";\nimport { CodeCell } from \"./fields/Code/index.js\";\nimport { cellComponents } from \"./fields/index.js\";\n\nexport const DefaultCell: React.FC<DefaultCellComponentProps> = (props) => {\n  const {\n    cellData,\n    className: classNameFromProps,\n    collectionSlug,\n    field,\n    field: { admin },\n    link,\n    onClick: onClickFromProps,\n    rowData,\n  } = props;\n\n  const { i18n } = useTranslation();\n\n  const {\n    config: {\n      routes: { admin: adminRoute },\n    },\n    getEntityConfig,\n  } = useConfig();\n\n  const collectionConfig = getEntityConfig({ collectionSlug });\n\n  const classNameFromConfigContext =\n    admin && \"className\" in admin ? admin.className : undefined;\n\n  const className =\n    classNameFromProps ||\n    (field.admin && \"className\" in field.admin\n      ? field.admin.className\n      : null) ||\n    classNameFromConfigContext;\n\n  const onClick = onClickFromProps;\n\n  let WrapElement: React.ComponentType<any> | string = \"span\";\n\n  const wrapElementProps: {\n    className?: string;\n    href?: string;\n    onClick?: () => void;\n    prefetch?: false;\n    type?: \"button\";\n  } = {\n    className,\n  };\n\n  if (link) {\n    wrapElementProps.prefetch = false;\n    WrapElement = Link;\n    wrapElementProps.href = collectionConfig?.slug\n      ? formatAdminURL({\n          adminRoute,\n          path: `/collections/${collectionConfig?.slug}/${encodeURIComponent(rowData.id)}`,\n        })\n      : \"\";\n  }\n\n  if (typeof onClick === \"function\") {\n    WrapElement = \"button\";\n    wrapElementProps.type = \"button\";\n    wrapElementProps.onClick = () => {\n      onClick({\n        cellData,\n        collectionSlug: collectionConfig?.slug,\n        rowData,\n      });\n    };\n  }\n\n  if (fieldIsID(field)) {\n    return (\n      <WrapElement {...wrapElementProps}>\n        <CodeCell\n          cellData={`ID: ${cellData}`}\n          collectionConfig={collectionConfig}\n          collectionSlug={collectionSlug}\n          field={{\n            ...field,\n            type: \"code\",\n          }}\n          nowrap\n          rowData={rowData}\n        />\n      </WrapElement>\n    );\n  }\n\n  const displayedValue = getDisplayedFieldValue(cellData, field, i18n);\n\n  const DefaultCellComponent: React.FC<DefaultCellComponentProps> =\n    typeof cellData !== \"undefined\" && cellComponents[field.type];\n\n  let CellComponent: React.ReactNode = null;\n\n  // Handle JSX labels before using DefaultCellComponent\n  if (React.isValidElement(displayedValue)) {\n    CellComponent = displayedValue;\n  } else if (DefaultCellComponent) {\n    CellComponent = (\n      <DefaultCellComponent cellData={cellData} rowData={rowData} {...props} />\n    );\n  } else if (!DefaultCellComponent) {\n    // DefaultCellComponent does not exist for certain field types like `text`\n    if (\n      collectionConfig?.upload &&\n      fieldAffectsData(field) &&\n      field.name === \"filename\" &&\n      field.type === \"text\"\n    ) {\n      const FileCellComponent = cellComponents.File;\n\n      CellComponent = (\n        <FileCellComponent\n          cellData={cellData}\n          rowData={rowData}\n          {...(props as DefaultCellComponentProps<UploadFieldClient>)}\n          collectionConfig={collectionConfig}\n          field={field}\n        />\n      );\n    } else {\n      return (\n        <WrapElement {...wrapElementProps}>\n          {(displayedValue === \"\" ||\n            typeof displayedValue === \"undefined\" ||\n            displayedValue === null) &&\n            i18n.t(\"general:noLabel\", {\n              label: getTranslation(\n                (\"label\" in field ? field.label : null) || \"data\",\n                i18n,\n              ),\n            })}\n          {typeof displayedValue === \"string\" && displayedValue}\n          {typeof displayedValue === \"number\" && displayedValue}\n          {typeof displayedValue === \"object\" &&\n            displayedValue !== null &&\n            JSON.stringify(displayedValue)}\n        </WrapElement>\n      );\n    }\n  }\n\n  if (\n    (field.type === \"select\" || field.type === \"radio\") &&\n    field.options.length &&\n    cellData\n  ) {\n    const classes = Array.isArray(cellData)\n      ? cellData.map((value) => `selected--${value}`).join(\" \")\n      : `selected--${cellData}`;\n\n    const className = [wrapElementProps.className, classes]\n      .filter(Boolean)\n      .join(\" \");\n\n    return (\n      <WrapElement {...wrapElementProps} className={className}>\n        {CellComponent}\n      </WrapElement>\n    );\n  }\n\n  return <WrapElement {...wrapElementProps}>{CellComponent}</WrapElement>;\n};\n"],"mappings":"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","ignoreList":[]}