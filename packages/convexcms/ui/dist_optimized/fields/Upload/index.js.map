{"version":3,"file":"index.js","names":["React","useMemo","useField","withCondition","useConfig","mergeFieldStyles","UploadInput","baseClass","UploadComponent","props","field","admin","allowCreate","className","description","isSortable","hasMany","label","localized","maxRows","relationTo","required","path","readOnly","validate","config","displayPreview","memoizedValidate","useCallback","value","options","customComponents","AfterInput","BeforeInput","Description","Error","Label","disabled","filterOptions","setValue","showError","styles","_jsx","api","routes","onChange","serverURL","style","UploadField"],"sources":["../../../src/fields/Upload/index.tsx"],"sourcesContent":["\"use client\";\n\nimport \"./index.scss\";\n\nimport type { UploadFieldClientProps } from \"@convexcms/core\";\nimport React, { useMemo } from \"react\";\n\nimport { useField } from \"../../forms/useField/index.js\";\nimport { withCondition } from \"../../forms/withCondition/index.js\";\nimport { useConfig } from \"../../providers/Config/index.js\";\nimport { mergeFieldStyles } from \"../mergeFieldStyles.js\";\nimport { UploadInput } from \"./Input.js\";\n\nexport { UploadInput } from \"./Input.js\";\nexport type { UploadInputProps } from \"./Input.js\";\n\nexport const baseClass = \"upload\";\n\nexport function UploadComponent(props: UploadFieldClientProps) {\n  const {\n    field,\n    field: {\n      admin: { allowCreate, className, description, isSortable } = {},\n      hasMany,\n      label,\n      localized,\n      maxRows,\n      relationTo,\n      required,\n    },\n    path,\n    readOnly,\n    validate,\n  } = props;\n\n  const { config } = useConfig();\n\n  const displayPreview = field.displayPreview;\n\n  const memoizedValidate = React.useCallback(\n    (value, options) => {\n      if (typeof validate === \"function\") {\n        return validate(value, { ...options, required });\n      }\n    },\n    [validate, required],\n  );\n\n  const {\n    customComponents: {\n      AfterInput,\n      BeforeInput,\n      Description,\n      Error,\n      Label,\n    } = {},\n    disabled,\n    filterOptions,\n    setValue,\n    showError,\n    value,\n  } = useField<string | string[]>({\n    path,\n    validate: memoizedValidate,\n  });\n\n  const styles = useMemo(() => mergeFieldStyles(field), [field]);\n\n  return (\n    <UploadInput\n      AfterInput={AfterInput}\n      allowCreate={allowCreate !== false}\n      api={config.routes.api}\n      BeforeInput={BeforeInput}\n      className={className}\n      Description={Description}\n      description={description}\n      displayPreview={displayPreview}\n      Error={Error}\n      filterOptions={filterOptions}\n      hasMany={hasMany}\n      isSortable={isSortable}\n      label={label}\n      Label={Label}\n      localized={localized}\n      maxRows={maxRows}\n      onChange={setValue}\n      path={path}\n      readOnly={readOnly || disabled}\n      relationTo={relationTo}\n      required={required}\n      serverURL={config.serverURL}\n      showError={showError}\n      style={styles}\n      value={value}\n    />\n  );\n}\n\nexport const UploadField = withCondition(UploadComponent);\n"],"mappings":"AAAA;;;AAEA,OAAO;AAGP,OAAOA,KAAA,IAASC,OAAO,QAAQ;AAE/B,SAASC,QAAQ,QAAQ;AACzB,SAASC,aAAa,QAAQ;AAC9B,SAASC,SAAS,QAAQ;AAC1B,SAASC,gBAAgB,QAAQ;AACjC,SAASC,WAAW,QAAQ;AAE5B,SAASA,WAAW,QAAQ;AAG5B,OAAO,MAAMC,SAAA,GAAY;AAEzB,OAAO,SAASC,gBAAgBC,KAA6B;EAC3D,MAAM;IACJC,KAAK;IACLA,KAAA,EAAO;MACLC,KAAA,EAAO;QAAEC,WAAW;QAAEC,SAAS;QAAEC,WAAW;QAAEC;MAAU,CAAE,GAAG,CAAC,CAAC;MAC/DC,OAAO;MACPC,KAAK;MACLC,SAAS;MACTC,OAAO;MACPC,UAAU;MACVC;IAAQ,CACT;IACDC,IAAI;IACJC,QAAQ;IACRC;EAAQ,CACT,GAAGf,KAAA;EAEJ,MAAM;IAAEgB;EAAM,CAAE,GAAGrB,SAAA;EAEnB,MAAMsB,cAAA,GAAiBhB,KAAA,CAAMgB,cAAc;EAE3C,MAAMC,gBAAA,GAAmB3B,KAAA,CAAM4B,WAAW,CACxC,CAACC,KAAA,EAAOC,OAAA;IACN,IAAI,OAAON,QAAA,KAAa,YAAY;MAClC,OAAOA,QAAA,CAASK,KAAA,EAAO;QAAE,GAAGC,OAAO;QAAET;MAAS;IAChD;EACF,GACA,CAACG,QAAA,EAAUH,QAAA,CAAS;EAGtB,MAAM;IACJU,gBAAA,EAAkB;MAChBC,UAAU;MACVC,WAAW;MACXC,WAAW;MACXC,KAAK;MACLC;IAAK,CACN,GAAG,CAAC,CAAC;IACNC,QAAQ;IACRC,aAAa;IACbC,QAAQ;IACRC,SAAS;IACTX;EAAK,CACN,GAAG3B,QAAA,CAA4B;IAC9BoB,IAAA;IACAE,QAAA,EAAUG;EACZ;EAEA,MAAMc,MAAA,GAASxC,OAAA,CAAQ,MAAMI,gBAAA,CAAiBK,KAAA,GAAQ,CAACA,KAAA,CAAM;EAE7D,oBACEgC,IAAA,CAACpC,WAAA;IACC0B,UAAA,EAAYA,UAAA;IACZpB,WAAA,EAAaA,WAAA,KAAgB;IAC7B+B,GAAA,EAAKlB,MAAA,CAAOmB,MAAM,CAACD,GAAG;IACtBV,WAAA,EAAaA,WAAA;IACbpB,SAAA,EAAWA,SAAA;IACXqB,WAAA,EAAaA,WAAA;IACbpB,WAAA,EAAaA,WAAA;IACbY,cAAA,EAAgBA,cAAA;IAChBS,KAAA,EAAOA,KAAA;IACPG,aAAA,EAAeA,aAAA;IACftB,OAAA,EAASA,OAAA;IACTD,UAAA,EAAYA,UAAA;IACZE,KAAA,EAAOA,KAAA;IACPmB,KAAA,EAAOA,KAAA;IACPlB,SAAA,EAAWA,SAAA;IACXC,OAAA,EAASA,OAAA;IACT0B,QAAA,EAAUN,QAAA;IACVjB,IAAA,EAAMA,IAAA;IACNC,QAAA,EAAUA,QAAA,IAAYc,QAAA;IACtBjB,UAAA,EAAYA,UAAA;IACZC,QAAA,EAAUA,QAAA;IACVyB,SAAA,EAAWrB,MAAA,CAAOqB,SAAS;IAC3BN,SAAA,EAAWA,SAAA;IACXO,KAAA,EAAON,MAAA;IACPZ,KAAA,EAAOA;;AAGb;AAEA,OAAO,MAAMmB,WAAA,GAAc7C,aAAA,CAAcK,eAAA","ignoreList":[]}