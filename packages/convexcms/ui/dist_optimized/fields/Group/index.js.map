{"version":3,"file":"index.js","names":["React","useMemo","getTranslation","useCollapsible","ErrorPill","RenderCustomComponent","FieldDescription","FieldLabel","useFormSubmitted","RenderFields","useField","withCondition","useTranslation","mergeFieldStyles","useRow","fieldBaseClass","useTabs","GroupProvider","useGroup","baseClass","GroupFieldComponent","props","field","name","admin","className","description","hideGutter","fields","label","path","permissions","readOnly","schemaPath","schemaPathFromProps","i18n","isWithinCollapsible","isWithinGroup","isWithinRow","isWithinTab","customComponents","AfterInput","BeforeInput","Description","Label","errorPaths","submitted","errorCount","length","fieldHasErrors","isTopLevel","styles","_jsxs","filter","Boolean","join","id","replace","style","_jsx","CustomComponent","Fallback","as","localized","required","count","withMessage","margins","parentIndexPath","parentPath","parentSchemaPath","GroupField"],"sources":["../../../src/fields/Group/index.tsx"],"sourcesContent":["\"use client\";\n\nimport \"./index.scss\";\n\nimport type { GroupFieldClientComponent } from \"@convexcms/core\";\nimport React, { useMemo } from \"react\";\nimport { getTranslation } from \"@convexcms/translations\";\n\nimport { useCollapsible } from \"../../elements/Collapsible/provider.js\";\nimport { ErrorPill } from \"../../elements/ErrorPill/index.js\";\nimport { RenderCustomComponent } from \"../../elements/RenderCustomComponent/index.js\";\nimport { FieldDescription } from \"../../fields/FieldDescription/index.js\";\nimport { FieldLabel } from \"../../fields/FieldLabel/index.js\";\nimport { useFormSubmitted } from \"../../forms/Form/context.js\";\nimport { RenderFields } from \"../../forms/RenderFields/index.js\";\nimport { useField } from \"../../forms/useField/index.js\";\nimport { withCondition } from \"../../forms/withCondition/index.js\";\nimport { useTranslation } from \"../../providers/Translation/index.js\";\nimport { mergeFieldStyles } from \"../mergeFieldStyles.js\";\nimport { useRow } from \"../Row/provider.js\";\nimport { fieldBaseClass } from \"../shared/index.js\";\nimport { useTabs } from \"../Tabs/provider.js\";\nimport { GroupProvider, useGroup } from \"./provider.js\";\n\nconst baseClass = \"group-field\";\n\nexport const GroupFieldComponent: GroupFieldClientComponent = (props) => {\n  const {\n    field,\n    field: {\n      name,\n      admin: { className, description, hideGutter } = {},\n      fields,\n      label,\n    },\n    path,\n    permissions,\n    readOnly,\n    schemaPath: schemaPathFromProps,\n  } = props;\n\n  const schemaPath = schemaPathFromProps ?? name;\n\n  const { i18n } = useTranslation();\n  const { isWithinCollapsible } = useCollapsible();\n  const isWithinGroup = useGroup();\n  const isWithinRow = useRow();\n  const isWithinTab = useTabs();\n\n  const {\n    customComponents: { AfterInput, BeforeInput, Description, Label } = {},\n    errorPaths,\n  } = useField({ path });\n\n  const submitted = useFormSubmitted();\n  const errorCount = errorPaths.length;\n  const fieldHasErrors = submitted && errorCount > 0;\n\n  const isTopLevel = !(isWithinCollapsible || isWithinGroup || isWithinRow);\n\n  const styles = useMemo(() => mergeFieldStyles(field), [field]);\n\n  return (\n    <div\n      className={[\n        fieldBaseClass,\n        baseClass,\n        isTopLevel && `${baseClass}--top-level`,\n        isWithinCollapsible && `${baseClass}--within-collapsible`,\n        isWithinGroup && `${baseClass}--within-group`,\n        isWithinRow && `${baseClass}--within-row`,\n        isWithinTab && `${baseClass}--within-tab`,\n        !hideGutter && isWithinGroup && `${baseClass}--gutter`,\n        fieldHasErrors && `${baseClass}--has-error`,\n        className,\n      ]\n        .filter(Boolean)\n        .join(\" \")}\n      id={`field-${path?.replace(/\\./g, \"__\")}`}\n      style={styles}\n    >\n      <GroupProvider>\n        <div className={`${baseClass}__wrap`}>\n          {Boolean(Label || Description || label || fieldHasErrors) && (\n            <div className={`${baseClass}__header`}>\n              {Boolean(Label || Description || label) && (\n                <header>\n                  <RenderCustomComponent\n                    CustomComponent={Label}\n                    Fallback={\n                      <h3 className={`${baseClass}__title`}>\n                        <FieldLabel\n                          as=\"span\"\n                          label={getTranslation(label, i18n)}\n                          localized={false}\n                          path={path}\n                          required={false}\n                        />\n                      </h3>\n                    }\n                  />\n                  <RenderCustomComponent\n                    CustomComponent={Description}\n                    Fallback={\n                      <FieldDescription description={description} path={path} />\n                    }\n                  />\n                </header>\n              )}\n              {fieldHasErrors && (\n                <ErrorPill count={errorCount} i18n={i18n} withMessage />\n              )}\n            </div>\n          )}\n          {BeforeInput}\n          <RenderFields\n            fields={fields}\n            margins=\"small\"\n            parentIndexPath=\"\"\n            parentPath={path}\n            parentSchemaPath={schemaPath}\n            permissions={\n              permissions === true ? permissions : permissions?.fields\n            }\n            readOnly={readOnly}\n          />\n        </div>\n      </GroupProvider>\n      {AfterInput}\n    </div>\n  );\n};\n\nexport { GroupProvider, useGroup };\n\nexport const GroupField = withCondition(GroupFieldComponent);\n"],"mappings":"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","ignoreList":[]}