{"version":3,"file":"index.js","names":["React","Fragment","useCallback","getTranslation","Banner","Button","DraggableSortableItem","DraggableSortable","DrawerToggler","useDrawerSlug","ErrorPill","RenderCustomComponent","useForm","useFormSubmitted","extractRowsAndCollapsedIDs","toggleAllRows","NullifyLocaleField","useField","withCondition","useConfig","useDocumentInfo","useLocale","useTranslation","scrollToID","FieldDescription","FieldError","FieldLabel","fieldBaseClass","BlockRow","BlocksDrawer","baseClass","BlocksFieldComponent","props","i18n","t","field","name","admin","className","description","isSortable","blockReferences","blocks","label","labels","labelsFromProps","localized","maxRows","minRows","minRowsProp","required","path","permissions","readOnly","schemaPath","schemaPathFromProps","validate","setDocFieldPreferences","addFieldRow","dispatchFields","moveFieldRow","removeFieldRow","setModified","code","locale","config","localization","drawerSlug","submitted","plural","singular","editingDefaultLocale","fallback","defaultLocale","memoizedValidate","value","options","customComponents","AfterInput","BeforeInput","Description","Error","Label","disabled","errorPaths","rows","showError","valid","hasRows","addRow","rowIndex","blockType","setTimeout","duplicateRow","type","removeRow","moveRow","moveFromIndex","moveToIndex","toggleCollapseAll","collapsed","collapsedIDs","updatedRows","setCollapse","rowID","hasMaxRows","length","fieldErrorCount","fieldHasErrors","showMinRows","showRequired","_jsxs","filter","Boolean","join","id","replace","_jsx","CustomComponent","Fallback","count","withMessage","onClick","fieldValue","ids","map","row","onDragEnd","i","isLoading","blockConfig","blocksMap","find","block","slug","rowPath","rowErrorCount","errorPath","startsWith","draggableSortableItemProps","errorCount","fields","RowLabel","parentPath","rowCount","buttonStyle","el","icon","iconPosition","iconStyle","addRowIndex","BlocksField"],"sources":["../../../src/fields/Blocks/index.tsx"],"sourcesContent":["\"use client\";\n\nimport \"./index.scss\";\n\nimport type { BlocksFieldClientComponent, ClientBlock } from \"@convexcms/core\";\nimport React, { Fragment, useCallback } from \"react\";\nimport { getTranslation } from \"@convexcms/translations\";\n\nimport { Banner } from \"../../elements/Banner/index.js\";\nimport { Button } from \"../../elements/Button/index.js\";\nimport { DraggableSortableItem } from \"../../elements/DraggableSortable/DraggableSortableItem/index.js\";\nimport { DraggableSortable } from \"../../elements/DraggableSortable/index.js\";\nimport { DrawerToggler } from \"../../elements/Drawer/index.js\";\nimport { useDrawerSlug } from \"../../elements/Drawer/useDrawerSlug.js\";\nimport { ErrorPill } from \"../../elements/ErrorPill/index.js\";\nimport { RenderCustomComponent } from \"../../elements/RenderCustomComponent/index.js\";\nimport { useForm, useFormSubmitted } from \"../../forms/Form/context.js\";\nimport {\n  extractRowsAndCollapsedIDs,\n  toggleAllRows,\n} from \"../../forms/Form/rowHelpers.js\";\nimport { NullifyLocaleField } from \"../../forms/NullifyField/index.js\";\nimport { useField } from \"../../forms/useField/index.js\";\nimport { withCondition } from \"../../forms/withCondition/index.js\";\nimport { useConfig } from \"../../providers/Config/index.js\";\nimport { useDocumentInfo } from \"../../providers/DocumentInfo/index.js\";\nimport { useLocale } from \"../../providers/Locale/index.js\";\nimport { useTranslation } from \"../../providers/Translation/index.js\";\nimport { scrollToID } from \"../../utilities/scrollToID.js\";\nimport { FieldDescription } from \"../FieldDescription/index.js\";\nimport { FieldError } from \"../FieldError/index.js\";\nimport { FieldLabel } from \"../FieldLabel/index.js\";\nimport { fieldBaseClass } from \"../shared/index.js\";\nimport { BlockRow } from \"./BlockRow.js\";\nimport { BlocksDrawer } from \"./BlocksDrawer/index.js\";\n\nconst baseClass = \"blocks-field\";\n\nconst BlocksFieldComponent: BlocksFieldClientComponent = (props) => {\n  const { i18n, t } = useTranslation();\n\n  const {\n    field: {\n      name,\n      admin: { className, description, isSortable = true } = {},\n      blockReferences,\n      blocks,\n      label,\n      labels: labelsFromProps,\n      localized,\n      maxRows,\n      minRows: minRowsProp,\n      required,\n    },\n    path,\n    permissions,\n    readOnly,\n    schemaPath: schemaPathFromProps,\n    validate,\n  } = props;\n\n  const schemaPath = schemaPathFromProps ?? name;\n\n  const minRows = (minRowsProp ?? required) ? 1 : 0;\n\n  const { setDocFieldPreferences } = useDocumentInfo();\n  const {\n    addFieldRow,\n    dispatchFields,\n    moveFieldRow,\n    removeFieldRow,\n    setModified,\n  } = useForm();\n  const { code: locale } = useLocale();\n  const {\n    config: { localization },\n    config,\n  } = useConfig();\n  const drawerSlug = useDrawerSlug(\"blocks-drawer\");\n  const submitted = useFormSubmitted();\n\n  const labels = {\n    plural: t(\"fields:blocks\"),\n    singular: t(\"fields:block\"),\n    ...labelsFromProps,\n  };\n\n  const editingDefaultLocale = (() => {\n    if (localization && localization.fallback) {\n      const defaultLocale = localization.defaultLocale;\n      return locale === defaultLocale;\n    }\n\n    return true;\n  })();\n\n  const memoizedValidate = useCallback(\n    (value, options) => {\n      // alternative locales can be null\n      if (!editingDefaultLocale && value === null) {\n        return true;\n      }\n      if (typeof validate === \"function\") {\n        return validate(value, { ...options, maxRows, minRows, required });\n      }\n    },\n    [maxRows, minRows, required, validate, editingDefaultLocale],\n  );\n\n  const {\n    customComponents: {\n      AfterInput,\n      BeforeInput,\n      Description,\n      Error,\n      Label,\n    } = {},\n    disabled,\n    errorPaths,\n    rows = [],\n    showError,\n    valid,\n    value,\n  } = useField<number>({\n    hasRows: true,\n    path,\n    validate: memoizedValidate,\n  });\n\n  const addRow = useCallback(\n    (rowIndex: number, blockType: string) => {\n      addFieldRow({\n        blockType,\n        path,\n        rowIndex,\n        schemaPath,\n      });\n\n      setTimeout(() => {\n        scrollToID(`${path}-row-${rowIndex + 1}`);\n      }, 0);\n    },\n    [addFieldRow, path, schemaPath],\n  );\n\n  const duplicateRow = useCallback(\n    (rowIndex: number) => {\n      dispatchFields({ type: \"DUPLICATE_ROW\", path, rowIndex });\n      setModified(true);\n\n      setTimeout(() => {\n        scrollToID(`${path}-row-${rowIndex + 1}`);\n      }, 0);\n    },\n    [dispatchFields, path, setModified],\n  );\n\n  const removeRow = useCallback(\n    (rowIndex: number) => {\n      removeFieldRow({\n        path,\n        rowIndex,\n      });\n    },\n    [path, removeFieldRow],\n  );\n\n  const moveRow = useCallback(\n    (moveFromIndex: number, moveToIndex: number) => {\n      moveFieldRow({ moveFromIndex, moveToIndex, path });\n    },\n    [moveFieldRow, path],\n  );\n\n  const toggleCollapseAll = useCallback(\n    (collapsed: boolean) => {\n      const { collapsedIDs, updatedRows } = toggleAllRows({\n        collapsed,\n        rows,\n      });\n\n      dispatchFields({ type: \"SET_ALL_ROWS_COLLAPSED\", path, updatedRows });\n      setDocFieldPreferences(path, { collapsed: collapsedIDs });\n    },\n    [dispatchFields, path, rows, setDocFieldPreferences],\n  );\n\n  const setCollapse = useCallback(\n    (rowID: string, collapsed: boolean) => {\n      const { collapsedIDs, updatedRows } = extractRowsAndCollapsedIDs({\n        collapsed,\n        rowID,\n        rows,\n      });\n\n      dispatchFields({ type: \"SET_ROW_COLLAPSED\", path, updatedRows });\n      setDocFieldPreferences(path, { collapsed: collapsedIDs });\n    },\n    [dispatchFields, path, rows, setDocFieldPreferences],\n  );\n\n  const hasMaxRows = maxRows && rows.length >= maxRows;\n\n  const fieldErrorCount = errorPaths.length;\n  const fieldHasErrors = submitted && fieldErrorCount + (valid ? 0 : 1) > 0;\n\n  const showMinRows = rows.length < minRows || (required && rows.length === 0);\n  const showRequired = readOnly && rows.length === 0;\n\n  return (\n    <div\n      className={[\n        fieldBaseClass,\n        baseClass,\n        className,\n        fieldHasErrors\n          ? `${baseClass}--has-error`\n          : `${baseClass}--has-no-error`,\n      ]\n        .filter(Boolean)\n        .join(\" \")}\n      id={`field-${path?.replace(/\\./g, \"__\")}`}\n    >\n      {showError && (\n        <RenderCustomComponent\n          CustomComponent={Error}\n          Fallback={<FieldError path={path} showError={showError} />}\n        />\n      )}\n      <header className={`${baseClass}__header`}>\n        <div className={`${baseClass}__header-wrap`}>\n          <div className={`${baseClass}__heading-with-error`}>\n            <h3>\n              <RenderCustomComponent\n                CustomComponent={Label}\n                Fallback={\n                  <FieldLabel\n                    label={label}\n                    localized={localized}\n                    path={path}\n                    required={required}\n                  />\n                }\n              />\n            </h3>\n            {fieldHasErrors && fieldErrorCount > 0 && (\n              <ErrorPill count={fieldErrorCount} i18n={i18n} withMessage />\n            )}\n          </div>\n          {rows.length > 0 && (\n            <ul className={`${baseClass}__header-actions`}>\n              <li>\n                <button\n                  className={`${baseClass}__header-action`}\n                  onClick={() => toggleCollapseAll(true)}\n                  type=\"button\"\n                >\n                  {t(\"fields:collapseAll\")}\n                </button>\n              </li>\n              <li>\n                <button\n                  className={`${baseClass}__header-action`}\n                  onClick={() => toggleCollapseAll(false)}\n                  type=\"button\"\n                >\n                  {t(\"fields:showAll\")}\n                </button>\n              </li>\n            </ul>\n          )}\n        </div>\n        <RenderCustomComponent\n          CustomComponent={Description}\n          Fallback={<FieldDescription description={description} path={path} />}\n        />\n      </header>\n      {BeforeInput}\n      <NullifyLocaleField\n        fieldValue={value}\n        localized={localized}\n        path={path}\n      />\n      {(rows.length > 0 || (!valid && (showRequired || showMinRows))) && (\n        <DraggableSortable\n          className={`${baseClass}__rows`}\n          ids={rows.map((row) => row.id)}\n          onDragEnd={({ moveFromIndex, moveToIndex }) =>\n            moveRow(moveFromIndex, moveToIndex)\n          }\n        >\n          {rows.map((row, i) => {\n            const { blockType, isLoading } = row;\n            const blockConfig: ClientBlock =\n              config.blocksMap[blockType] ??\n              ((blockReferences ?? blocks).find(\n                (block) =>\n                  typeof block !== \"string\" && block.slug === blockType,\n              ) as ClientBlock);\n\n            if (blockConfig) {\n              const rowPath = `${path}.${i}`;\n\n              const rowErrorCount = errorPaths.filter((errorPath) =>\n                errorPath.startsWith(rowPath + \".\"),\n              ).length;\n\n              return (\n                <DraggableSortableItem\n                  disabled={readOnly || disabled || !isSortable}\n                  id={row.id}\n                  key={row.id}\n                >\n                  {(draggableSortableItemProps) => (\n                    <BlockRow\n                      {...draggableSortableItemProps}\n                      addRow={addRow}\n                      block={blockConfig}\n                      blocks={blockReferences ?? blocks}\n                      duplicateRow={duplicateRow}\n                      errorCount={rowErrorCount}\n                      fields={blockConfig.fields}\n                      hasMaxRows={hasMaxRows}\n                      isLoading={isLoading}\n                      isSortable={isSortable}\n                      Label={rows?.[i]?.customComponents?.RowLabel}\n                      labels={labels}\n                      moveRow={moveRow}\n                      parentPath={path}\n                      path={rowPath}\n                      permissions={permissions}\n                      readOnly={readOnly || disabled}\n                      removeRow={removeRow}\n                      row={row}\n                      rowCount={rows.length}\n                      rowIndex={i}\n                      schemaPath={schemaPath + blockConfig.slug}\n                      setCollapse={setCollapse}\n                    />\n                  )}\n                </DraggableSortableItem>\n              );\n            }\n\n            return null;\n          })}\n          {!editingDefaultLocale && (\n            <React.Fragment>\n              {showMinRows && (\n                <Banner type=\"error\">\n                  {t(\"validation:requiresAtLeast\", {\n                    count: minRows,\n                    label:\n                      getTranslation(\n                        minRows > 1 ? labels.plural : labels.singular,\n                        i18n,\n                      ) || t(minRows > 1 ? \"general:row\" : \"general:rows\"),\n                  })}\n                </Banner>\n              )}\n              {showRequired && (\n                <Banner>\n                  {t(\"validation:fieldHasNo\", {\n                    label: getTranslation(labels.plural, i18n),\n                  })}\n                </Banner>\n              )}\n            </React.Fragment>\n          )}\n        </DraggableSortable>\n      )}\n      {!hasMaxRows && (\n        <Fragment>\n          <DrawerToggler\n            className={`${baseClass}__drawer-toggler`}\n            disabled={readOnly || disabled}\n            slug={drawerSlug}\n          >\n            <Button\n              buttonStyle=\"icon-label\"\n              disabled={readOnly || disabled}\n              el=\"span\"\n              icon=\"plus\"\n              iconPosition=\"left\"\n              iconStyle=\"with-border\"\n            >\n              {t(\"fields:addLabel\", {\n                label: getTranslation(labels.singular, i18n),\n              })}\n            </Button>\n          </DrawerToggler>\n          <BlocksDrawer\n            addRow={addRow}\n            addRowIndex={rows?.length || 0}\n            blocks={blockReferences ?? blocks}\n            drawerSlug={drawerSlug}\n            labels={labels}\n          />\n        </Fragment>\n      )}\n      {AfterInput}\n    </div>\n  );\n};\n\nexport const BlocksField = withCondition(BlocksFieldComponent);\n"],"mappings":"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","ignoreList":[]}